(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     18524,        470]
NotebookOptionsPosition[     18117,        455]
NotebookOutlinePosition[     18471,        471]
CellTagsIndexPosition[     18428,        468]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Mathematica", " ", "expression", " ", "related", " ", "funcs"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"setTimeVars", "[", "vs_", "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vs", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vs", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TurnToEq", "[", 
      RowBox[{"list1_", ",", "list2_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Flatten", "[", "list1", "]"}]}], ";", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"tmp", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "==", 
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "tmp", "]"}]}], "}"}]}], "]"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lToMass", "[", "l_", "]"}], ":=", "l"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lToInertia", "[", "l_", "]"}], ":=", 
    RowBox[{"l", "^", "2"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Create", " ", "objects"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pushVars", "[", "nDOF_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"objqs", ",", "objqsvars"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"objqsvars", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Symbol", "[", 
           RowBox[{"\"\<$q\>\"", "<>", 
            RowBox[{"ToString", "@", "i"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"nVars", "+", "1"}], ",", 
            RowBox[{"nVars", "+", "nDOF"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"x", " ", "\[Rule]", " ", 
         RowBox[{"x", "[", "t", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"objqs", "=", 
        RowBox[{"setTimeVars", "[", "objqsvars", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Update", " ", "vars"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"qs", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"qs", ",", "objqs"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"qsvars", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"qsvars", ",", "objqsvars"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nVars", "=", 
        RowBox[{"nVars", "+", "nDOF"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"objqs", ",", "objqsvars"}], "}"}]}]}], "\[IndentingNewLine]",
      "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"UpdateObjVertexs", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pFront_", ",", "pBack_"}], "}"}], ",", "nthGroup_"}], "]"}], 
     ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"impObjVertexs", ",", 
          RowBox[{"{", 
           RowBox[{"pFront", ",", "pBack"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "An", " ", "example", " ", "of", " ", "impObjVertexs", " ", "from", 
          " ", "one", " ", "link", " ", "and", " ", "one", " ", 
          RowBox[{"wall", ":", "\[IndentingNewLine]", 
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {
               RowBox[{"(", "\[NoBreak]", GridBox[{
                  {
                   RowBox[{" ", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"$q3", "[", "t", "]"}], "]"}], "+", 
                    RowBox[{"$q1", "[", "t", "]"}]}]}]},
                  {
                   RowBox[{
                    RowBox[{"Sin", "[", 
                    RowBox[{"$q3", "[", "t", "]"}], "]"}], "+", 
                    RowBox[{"$q2", "[", "t", "]"}]}]},
                  {"0.`"},
                  {"1.`"}
                 },
                 
                 GridBoxAlignment->{
                  "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.7]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
               
               RowBox[{"(", "\[NoBreak]", GridBox[{
                  {
                   RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"$q3", "[", "t", "]"}], "]"}], "+", 
                    RowBox[{"$q1", "[", "t", "]"}]}]},
                  {
                   RowBox[{" ", 
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    RowBox[{"$q3", "[", "t", "]"}], "]"}], "+", 
                    RowBox[{"$q2", "[", "t", "]"}]}]}]},
                  {"0.`"},
                  {"1.`"}
                 },
                 
                 GridBoxAlignment->{
                  "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.7]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", 
                ")"}]},
              {
               RowBox[{"(", "\[NoBreak]", GridBox[{
                  {"0"},
                  {"0"},
                  {"0"},
                  {"1"}
                 },
                 
                 GridBoxAlignment->{
                  "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.7]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
               
               RowBox[{"(", "\[NoBreak]", GridBox[{
                  {"0"},
                  {
                   RowBox[{"-", "4"}]},
                  {"0"},
                  {"1"}
                 },
                 
                 GridBoxAlignment->{
                  "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.7]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.7]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}], ")"}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"impObjVertexGroupIDs", ",", "nthGroup"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pushPEnds", "[", 
     RowBox[{"T_", ",", "l_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pFront", ",", "pBack", ",", "TFront", ",", "TBack"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pFront", "=", 
        RowBox[{
         RowBox[{"T", ".", 
          SuperscriptBox[
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"l", "/", "2"}], ",", "0", ",", "0", ",", "1"}], "}"}], 
            "}"}], "\[Transpose]"]}], "//", "Simplify"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pBack", "=", 
        RowBox[{
         RowBox[{"T", ".", 
          SuperscriptBox[
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "l"}], "/", "2"}], ",", "0", ",", "0", ",", "1"}],
              "}"}], "}"}], "\[Transpose]"]}], "//", "Simplify"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TFront", "=", 
        RowBox[{"T", ".", 
         RowBox[{"Trans4", "[", 
          RowBox[{
           RowBox[{"l", "/", "2"}], ",", "0"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TBack", "=", 
        RowBox[{"T", ".", 
         RowBox[{"Trans4", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "l"}], "/", "2"}], ",", "0"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"pFront", "=", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{"pFront", ",", 
          RowBox[{"qs", "\[Element]", "Reals"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pBack", "=", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{"pBack", ",", 
          RowBox[{"qs", "\[Element]", "Reals"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TFront", "=", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{"TFront", ",", 
          RowBox[{"qs", "\[Element]", "Reals"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TBack", "=", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{"TBack", ",", 
          RowBox[{"qs", "\[Element]", "Reals"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"pFronts", ",", "pFront"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"pBacks", ",", "pBack"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"pFront", ",", "pBack", ",", "TFront", ",", "TBack"}], 
        "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PushVertex", "[", 
      RowBox[{"p_", ",", "nthGroup_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"impObjVertexs", ",", "p"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"impObjVertexGroupIDs", ",", "nthGroup"}], "]"}], ";"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PushEdge", "[", 
      RowBox[{"p1p2_", ",", "nthGroup_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"impObjEdges", ",", "p1p2"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"impObjEdgeGroupIDs", ",", "nthGroup"}], "]"}], ";"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pushT", "[", "T_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"Ts", ",", "T"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CalcAndPushT", "[", 
      RowBox[{"x_", ",", "y_", ",", "\[Theta]_", ",", "l_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "T", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"T", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Trans4", "[", 
            RowBox[{"x", ",", "y"}], "]"}], ".", 
           RowBox[{"Rotz4", "[", "\[Theta]", "]"}]}], "//", "Simplify"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"T", "=", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{"T", ",", 
           RowBox[{"qs", "\[Element]", "Reals"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"pFront", ",", "pBack", ",", "TFront", ",", "TBack"}], 
          "}"}], "=", 
         RowBox[{"pushPEnds", "[", 
          RowBox[{"T", ",", "l"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pushT", "[", "T", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "T", ",", "pFront", ",", "pBack", ",", "TFront", ",", "TBack"}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pushLensMassInertia", "[", "l_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mass", ",", "inertia"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mass", "=", 
         RowBox[{"lToMass", "[", "l", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"inertia", "=", 
         RowBox[{"lToInertia", "[", "l", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"AppendTo", "[", 
         RowBox[{"masses", ",", "mass"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"inertias", ",", "inertia"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"lens", ",", "l"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.753178871503525*^9, {3.753178943913477*^9, 3.753179051729616*^9}, {
   3.753179095527733*^9, 3.753179124041339*^9}, {3.753179218829652*^9, 
   3.75317921896362*^9}, {3.753179864724807*^9, 3.753179906424315*^9}, 
   3.753180099614407*^9, {3.7531801484228363`*^9, 3.753180151898964*^9}, 
   3.753180295630445*^9, {3.753181007486519*^9, 3.753181060011223*^9}, {
   3.753181091420342*^9, 3.753181131018433*^9}, 3.7531811615802*^9, {
   3.753181626430949*^9, 3.7531816266113567`*^9}, {3.7531818485978937`*^9, 
   3.753181941648856*^9}, {3.753181975327026*^9, 3.753181976901577*^9}, {
   3.75318546801507*^9, 3.753185513007131*^9}, {3.753185597066115*^9, 
   3.753185657705818*^9}, {3.753185744515497*^9, 3.753185763211626*^9}, {
   3.753185830935637*^9, 3.753185871987295*^9}, 3.753185905049992*^9, {
   3.753189667909758*^9, 3.7531897336256657`*^9}, {3.753193500770018*^9, 
   3.753193507828301*^9}, {3.753217015323701*^9, 3.7532170156708612`*^9}, {
   3.753228862211137*^9, 3.753228870966243*^9}, {3.753233217432487*^9, 
   3.7532332334820957`*^9}, {3.7532342316644773`*^9, 
   3.7532344380860023`*^9}, {3.753234847528041*^9, 3.753234848955483*^9}, {
   3.753235072890409*^9, 3.7532350745580587`*^9}, {3.753235112181641*^9, 
   3.753235131310133*^9}, {3.753235457502335*^9, 3.75323549597366*^9}, 
   3.753235738110529*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"09eae57e-490c-41ed-abcd-b582021719d9"],

Cell[BoxData[{
 RowBox[{"printImpactCases", ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Totally \>\"", ",", 
      RowBox[{"Length", "[", "\[Phi]sIsClose", "]"}], ",", 
      "\"\< impacts:\>\""}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"MF", "[", "\[Phi]sIsClose", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printTs", "[", "i_", "]"}], ":=", 
   RowBox[{"Print", "[", 
    RowBox[{"MF", "[", 
     RowBox[{"Ts", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"printVertex", ":=", 
   RowBox[{"Print", "[", 
    RowBox[{"MF", "[", 
     RowBox[{
     "\"\<Vertices group ID: \>\"", ",", "impObjVertexGroupIDs", ",", 
      "\"\<\\nVertices location: \>\"", ",", 
      RowBox[{"MF", "[", "impObjVertexs", "]"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.753277841702056*^9, 3.7532778963865*^9}, {
  3.75329434624304*^9, 3.7532943603460712`*^9}, {3.753294442931424*^9, 
  3.753294520879572*^9}},
 CellLabel->
  "In[1281]:=",ExpressionUUID->"b7848703-504f-4eb0-b18c-2b29fc0d60c9"]
},
WindowSize->{866, 847},
WindowMargins->{{63, Automatic}, {64, Automatic}},
Magnification->1.5,
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 16321, 399, 2764, "Input",ExpressionUUID->"09eae57e-490c-41ed-abcd-b582021719d9"],
Cell[16882, 421, 1231, 32, 309, "Input",ExpressionUUID->"b7848703-504f-4eb0-b18c-2b29fc0d60c9"]
}
]
*)

