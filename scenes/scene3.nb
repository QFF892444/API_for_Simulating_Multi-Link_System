(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     10608,        237]
NotebookOptionsPosition[     10297,        223]
NotebookOutlinePosition[     10654,        239]
CellTagsIndexPosition[     10611,        236]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Put", " ", "your", " ", "code", " ", "here", " ", "to", " ", "create", 
    " ", "links", " ", "system"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CreatePolygon", "[", 
      RowBox[{"p0_", ",", "p1_", ",", "NumOfEdges_", ",", "DOF_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"l", "=", 
         RowBox[{"CalcDistpp", "[", 
          RowBox[{"p0", ",", "p1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DOF", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"linki", "=", 
           RowBox[{"createLink0DOFpp", "[", 
            RowBox[{"p0", ",", "p1"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"linki", "=", 
           RowBox[{"createLink3DOFpp", "[", 
            RowBox[{"p0", ",", "p1"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"NumOfEdges", "-", "1"}]}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"linki", "=", 
           RowBox[{"createLink0DOFg\[Theta]l", "[", 
            RowBox[{
             RowBox[{"linki", "[", 
              RowBox[{"[", "IdxTFront", "]"}], "]"}], ",", 
             RowBox[{"2", "*", 
              RowBox[{"Pi", "/", "NumOfEdges"}]}], ",", "l"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CreateObjects", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Object", " ", "1"}], ":", " ", "Triangle"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nthGroup", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"initRandVelocity", "=", "0.5"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"CreatePolygon", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.5"}], ",", "2.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.1", ",", "2.7"}], "}"}], ",", "3", ",", "3"}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Objects", " ", "2"}], ":", " ", "Walls"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"nthGroup", "=", "2"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"CreatePolygon", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "4.5"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "3.5"}], ",", "1"}], "}"}], ",", "4", ",", "0"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"CreatePolygon", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2.5"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1.5"}], ",", "1"}], "}"}], ",", "4", ",", "0"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"CreatePolygon", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.5"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.5", ",", "1"}], "}"}], ",", "4", ",", "0"}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"CreatePolygon", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1.5", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2.5", ",", "1"}], "}"}], ",", "4", ",", "0"}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"CreatePolygon", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3.5", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4.5", ",", "1"}], "}"}], ",", "4", ",", "0"}], "]"}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Objects", " ", "3"}], ":", " ", 
          RowBox[{"Wall", " ", "of", " ", "Floor"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"createLink0DOFpp", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "20"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "0"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"createLink0DOFpp", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "3.9"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "3.9"}], ",", "3"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"createLink0DOFpp", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3.9", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3.9", ",", "3"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"no", " ", "external", " ", "forces"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"externalForces", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", "nVars"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.753293812463093*^9, 3.7532940005580797`*^9}, 
   3.7532940430284433`*^9, {3.7532941199813547`*^9, 3.7532941533221283`*^9}, {
   3.753294292303938*^9, 3.7532942991160393`*^9}, 3.753294876600243*^9, {
   3.7532969780645*^9, 3.753296992820109*^9}, {3.753297406682959*^9, 
   3.75329743000552*^9}, 3.753299709311103*^9, {3.753299802182394*^9, 
   3.753299802187414*^9}, {3.753299974309808*^9, 3.753299974312595*^9}, {
   3.753300133339365*^9, 3.7533005234130077`*^9}, 3.753301120717215*^9, {
   3.753301293348412*^9, 3.753301303496265*^9}, {3.7533020192900267`*^9, 
   3.75330203694129*^9}, {3.753302084193254*^9, 3.7533020897657757`*^9}, {
   3.753302398442281*^9, 3.753302399725256*^9}, {3.753302472526751*^9, 
   3.753302476163178*^9}, {3.753302930133869*^9, 3.753302931207673*^9}, {
   3.753303158109784*^9, 3.753303163533121*^9}, {3.753303385598418*^9, 
   3.753303388031534*^9}, {3.753304049109066*^9, 3.753304052389619*^9}, {
   3.753304091269246*^9, 3.753304119006625*^9}, 3.753304302058569*^9, 
   3.7533043720911417`*^9, {3.753304509436829*^9, 3.753304510623822*^9}, 
   3.753304734900848*^9, 3.7533048140290833`*^9, {3.7533088481942883`*^9, 
   3.753308865625579*^9}, {3.7533092909920673`*^9, 3.753309302620627*^9}, {
   3.753309519193993*^9, 3.753309559462679*^9}, {3.7533096196323977`*^9, 
   3.753309766595868*^9}, 3.753310475090274*^9, {3.7533105238243847`*^9, 
   3.7533105279244127`*^9}, {3.753310621205858*^9, 3.753310623121642*^9}, {
   3.753310873728388*^9, 3.753310918596047*^9}, {3.753310970215769*^9, 
   3.753310971717257*^9}, {3.753311120199114*^9, 3.75331125463636*^9}, {
   3.753311324796945*^9, 3.753311530004641*^9}, {3.7533123478083553`*^9, 
   3.753312350061817*^9}, {3.753317678583756*^9, 3.7533177009723797`*^9}, {
   3.753317787401149*^9, 3.7533178514134293`*^9}, {3.753317918647341*^9, 
   3.753317971888406*^9}, {3.753318054684409*^9, 3.753318150816609*^9}, {
   3.7533184785308104`*^9, 3.753318496248075*^9}, {3.753318540330317*^9, 
   3.753318581303832*^9}, {3.753318618145952*^9, 3.7533186202989817`*^9}, {
   3.7533186795704308`*^9, 3.753318771737042*^9}, {3.753318968536484*^9, 
   3.753319009417592*^9}, {3.7533191663130283`*^9, 3.753319168774723*^9}, {
   3.753319864819325*^9, 3.753319866486107*^9}, {3.7533243403563223`*^9, 
   3.753324407728633*^9}, {3.7533246049152718`*^9, 3.753324632681582*^9}, {
   3.753324895999797*^9, 3.7533249530238934`*^9}, {3.7533250460422163`*^9, 
   3.7533250480861*^9}, {3.753326637281966*^9, 3.753326640773918*^9}, {
   3.753327180937429*^9, 3.7533272509566936`*^9}, {3.753327688197113*^9, 
   3.753327829550514*^9}, {3.753327862637727*^9, 3.7533278854809628`*^9}, {
   3.753327916239573*^9, 3.753327934600523*^9}, {3.753646616617049*^9, 
   3.7536466167460337`*^9}, {3.753745922993664*^9, 3.7537459230464973`*^9}, {
   3.753748601378818*^9, 3.7537486436591177`*^9}, {3.753748685793491*^9, 
   3.753748981871167*^9}, {3.753749252381288*^9, 3.7537492870244617`*^9}, {
   3.753749323291809*^9, 3.7537493438007936`*^9}, {3.753749399167804*^9, 
   3.75374941207969*^9}, {3.753749519470015*^9, 3.753749529926406*^9}, {
   3.7537496758070173`*^9, 3.753749728041236*^9}, {3.753749803774246*^9, 
   3.753749815061721*^9}, {3.753749858376554*^9, 3.7537498915599823`*^9}, {
   3.753750093798395*^9, 3.753750118544298*^9}, {3.7537504204832706`*^9, 
   3.753750482341364*^9}, {3.753750543126916*^9, 3.753750609321169*^9}, {
   3.753750675175599*^9, 3.7537506786465883`*^9}, {3.7537507135128183`*^9, 
   3.7537508622104197`*^9}, {3.75375095721583*^9, 3.7537509583330727`*^9}, 
   3.7537509894757643`*^9, {3.7537510688406076`*^9, 3.753751074962125*^9}, {
   3.753751129387972*^9, 3.753751131420086*^9}, {3.753751180768787*^9, 
   3.753751219899681*^9}, {3.753751417350171*^9, 3.753751417434836*^9}, {
   3.753751501964246*^9, 3.753751503879613*^9}, {3.753987665746244*^9, 
   3.7539876660847073`*^9}, {3.75398779743472*^9, 3.753987824344345*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"79b9a627-51db-457f-a73f-89b8cf4d97bf"]
},
WindowSize->{1440, 671},
WindowMargins->{{Automatic, 136}, {39, Automatic}},
Magnification->1.25,
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 9735, 201, 997, "Input",ExpressionUUID->"79b9a627-51db-457f-a73f-89b8cf4d97bf"]
}
]
*)

