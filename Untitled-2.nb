(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16391,        453]
NotebookOptionsPosition[     13596,        396]
NotebookOutlinePosition[     13953,        412]
CellTagsIndexPosition[     13910,        409]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"MF", "[", "T2", "]"}]], "Input",
 CellChangeTimes->{{3.753229164539113*^9, 3.75322919349618*^9}, 
   3.753230259741403*^9, 3.7532307725871677`*^9, {3.753230813148869*^9, 
   3.753230895585423*^9}, {3.753230955392671*^9, 3.753230957076528*^9}, {
   3.753231046512199*^9, 3.753231055468729*^9}, 3.753233905043157*^9, {
   3.753234064522194*^9, 3.753234064603553*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"6799d7ae-1d61-46dc-bb78-f273d45a672a"],

Cell[BoxData[
 TagBox["T2",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.753229162234043*^9, 3.7532291966190443`*^9}, 
   3.753230260043083*^9, 3.753230773002907*^9, {3.753230814830578*^9, 
   3.7532308358577023`*^9}, 3.753230896378359*^9, {3.753230953846383*^9, 
   3.753230957367155*^9}, 3.7532310557942543`*^9, 3.753231544947165*^9, {
   3.75323173737626*^9, 3.7532317476599197`*^9}, 3.753233905428049*^9, 
   3.753233962897749*^9, 3.7532340649863873`*^9, 3.753235212410293*^9, 
   3.753273355577621*^9},
 CellLabel->
  "Out[50]//MatrixForm=",ExpressionUUID->"0458b4a3-c37d-40a5-8049-\
368961c2ed78"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MF", "[", "\[Phi]sIsInLine", "]"}]], "Input",
 CellChangeTimes->{{3.753235549524519*^9, 3.7532355603896837`*^9}, {
  3.7532357172518787`*^9, 3.75323579949242*^9}, {3.753235961070476*^9, 
  3.753235965166074*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"9b5cbfb0-a1b2-493d-afbd-773d24a5ea3e"],

Cell[BoxData[
 TagBox["\[Phi]sIsInLine",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.753235550128627*^9, 3.7532355608575277`*^9}, {
   3.753235717739205*^9, 3.753235747837008*^9}, {3.7532357780192757`*^9, 
   3.753235800156479*^9}, {3.7532359616703367`*^9, 3.7532359656903143`*^9}, 
   3.753273355598547*^9},
 CellLabel->
  "Out[51]//MatrixForm=",ExpressionUUID->"b74cfdc6-3d33-46bb-8207-\
eb5a5f5ece20"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MF", "[", 
  RowBox[{"Ts", "[", 
   RowBox[{"[", "2", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.753235413816145*^9, 3.75323544293935*^9}, {
  3.753235502178527*^9, 3.753235502260971*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"04613cca-770c-4966-8a56-83fe55400a42"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"Ts\\\", \
\\\"\[LeftDoubleBracket]\\\", \\\"2\\\", \\\"\[RightDoubleBracket]\\\"}]\\) \
is longer than depth of object.\"",2,52,3,21829794131350518457,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.753273355619096*^9},
 CellLabel->
  "During evaluation of \
In[52]:=",ExpressionUUID->"003cda68-f656-48fa-b51f-7fc748ca7fee"],

Cell[BoxData[
 TagBox[
  RowBox[{"Ts", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7532354018184013`*^9, 3.753235443226013*^9}, {
   3.753235500950439*^9, 3.753235518255219*^9}, 3.753273355625821*^9},
 CellLabel->
  "Out[52]//MatrixForm=",ExpressionUUID->"d39d7b35-b635-4aa6-ac9c-\
0f5dd02e2e3c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["inertias"], "Input",
 CellLabel->"In[53]:=",ExpressionUUID->"c68fa186-57de-419b-a800-de459d083f95"],

Cell[BoxData["inertias"], "Output",
 CellChangeTimes->{{3.7532352961325502`*^9, 3.753235334385502*^9}, 
   3.753235403227289*^9, 3.753273355646447*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"04b6f785-faaa-4989-9b7d-4b6ccea29839"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Trans4", "[", 
  RowBox[{
   RowBox[{"l", "/", "2"}], ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{
  3.753231425033361*^9, {3.753231680243362*^9, 3.7532316957256308`*^9}, {
   3.7532324141337843`*^9, 3.753232417144745*^9}, {3.753232620111701*^9, 
   3.753232627339292*^9}, {3.753234013410398*^9, 3.753234024095752*^9}, {
   3.753234815699147*^9, 3.753234817396171*^9}, 3.75323485647682*^9},
 CellLabel->"In[54]:=",ExpressionUUID->"d3752458-8680-41fc-bfdd-442d13278103"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", 
     FractionBox["l", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7532348177035217`*^9, 3.7532348570757504`*^9, 
  3.753273355667205*^9},
 CellLabel->"Out[54]=",ExpressionUUID->"6a5eb656-e22f-4887-a5b7-0eb9f00e026c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"y", "=", "0"}]], "Input",
 CellChangeTimes->{{3.753274561773088*^9, 3.7532745623337393`*^9}},
 CellLabel->
  "In[730]:=",ExpressionUUID->"be92e993-f061-461f-be53-ae5d8181986d"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.753274563345364*^9},
 CellLabel->
  "Out[730]=",ExpressionUUID->"0e5d59c1-a3e1-4694-b936-7c4b62d49e96"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.753274387304986*^9, 3.7532743980481*^9}, {
   3.7532745426072083`*^9, 3.753274595653289*^9}, 
   3.7532746422516613`*^9},ExpressionUUID->"269105b2-d3a7-49d4-aba4-\
5e2d6421f209"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.753274643627005*^9},ExpressionUUID->"96d0ef26-c1c6-40cf-930c-\
ae1ea361bf41"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "[", "x_", "]"}], ":=", 
  RowBox[{"Hold", "[", 
   RowBox[{"y", "=", "x"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"f", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReleaseHold", "[", 
   RowBox[{"res", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", "y"}], "Input",
 CellChangeTimes->{{3.753231092455625*^9, 3.7532311198711157`*^9}, 
   3.753231332892185*^9, {3.7532742860085506`*^9, 3.7532743214206448`*^9}, {
   3.753274375317802*^9, 3.753274417705653*^9}, {3.7532744744860477`*^9, 
   3.753274550890278*^9}, {3.753274602352853*^9, 
   3.7532746460445633`*^9}},ExpressionUUID->"3bea0739-b28a-4967-8be4-\
efbed6b6e26c"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.7532745974585733`*^9, 3.753274638753251*^9}},
 CellLabel->
  "Out[747]=",ExpressionUUID->"da616266-adbe-4755-99c6-07c52f99a343"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["y"], "Input",
 CellChangeTimes->{3.753274582889435*^9},
 CellLabel->
  "In[734]:=",ExpressionUUID->"1af57f4a-749e-438e-83a9-b3157f4ffe30"],

Cell[BoxData[
 RowBox[{"Hold", "[", "3", "]"}]], "Output",
 CellChangeTimes->{{3.753274301799975*^9, 3.753274321827218*^9}, {
  3.753274376831027*^9, 3.7532744180437613`*^9}, {3.753274477770359*^9, 
  3.7532745149546003`*^9}, {3.7532745455565357`*^9, 3.753274583327951*^9}},
 CellLabel->
  "Out[734]=",ExpressionUUID->"829b8e23-9dd6-416d-88cf-926648ef2211"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pFront1", "[", 
  RowBox[{"[", 
   RowBox[{
    RowBox[{"1", ";;", "2"}], ",", "1"}], "]"}], "]"}]], "Input",
 CellLabel->"In[56]:=",ExpressionUUID->"6976f7ed-d55c-40e2-8a85-ac38c807baf0"],

Cell[BoxData[
 TemplateBox[{
  "Part","take",
   "\"Cannot take positions \\!\\(\\*RowBox[{\\\"1\\\"}]\\) through \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) in \\!\\(\\*RowBox[{\\\"pFront1\\\"}]\\).\"",
   2,56,5,21829794131350518457,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7532733557149057`*^9},
 CellLabel->
  "During evaluation of \
In[56]:=",ExpressionUUID->"b3236b09-33fa-44e5-899e-8ed89dc46843"],

Cell[BoxData[
 RowBox[{"pFront1", "\[LeftDoubleBracket]", 
  RowBox[{
   RowBox[{"1", ";;", "2"}], ",", "1"}], "\[RightDoubleBracket]"}]], "Output",\

 CellChangeTimes->{3.7532300465916452`*^9, 3.7532733557159643`*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"db2ffa1f-ee31-414b-94c6-6154f735e785"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MF", "[", "\[Phi]sIsClose", "]"}]], "Input",
 CellChangeTimes->{{3.753229174063807*^9, 3.7532291770054073`*^9}, {
  3.753229978915374*^9, 3.753229983694965*^9}, {3.7532735408015327`*^9, 
  3.753273548829341*^9}},
 CellLabel->
  "In[280]:=",ExpressionUUID->"6b4079d3-a223-4e38-b465-d74920e70c6b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"2", "-", 
        RowBox[{"0.5`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}]}], "-", 
        RowBox[{"$q2", "[", "t", "]"}]}]},
      {
       RowBox[{"2", "-", 
        RowBox[{"0.5`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}]}], "-", 
        RowBox[{"$q1", "[", "t", "]"}]}]},
      {
       RowBox[{"2", "+", 
        RowBox[{"0.5`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"$q2", "[", "t", "]"}]}]},
      {
       RowBox[{"2", "+", 
        RowBox[{"0.5`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"$q1", "[", "t", "]"}]}]},
      {
       RowBox[{"2", "+", 
        RowBox[{"0.5`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}]}], "-", 
        RowBox[{"$q2", "[", "t", "]"}]}]},
      {
       RowBox[{"2", "+", 
        RowBox[{"0.5`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}]}], "-", 
        RowBox[{"$q1", "[", "t", "]"}]}]},
      {
       RowBox[{"2", "-", 
        RowBox[{"0.5`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"$q2", "[", "t", "]"}]}]},
      {
       RowBox[{"2", "-", 
        RowBox[{"0.5`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"$q1", "[", "t", "]"}]}]},
      {
       RowBox[{
        RowBox[{"2.`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}]}], "-", 
        RowBox[{"2.`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"1.`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"$q1", "[", "t", "]"}]}], "-", 
        RowBox[{"1.`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"$q2", "[", "t", "]"}]}]}]},
      {
       RowBox[{
        RowBox[{"2.`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"2.`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"1.`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"$q1", "[", "t", "]"}]}], "-", 
        RowBox[{"1.`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"$q2", "[", "t", "]"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", "2.`"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}]}], "-", 
        RowBox[{"2.`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"1.`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"$q1", "[", "t", "]"}]}], "-", 
        RowBox[{"1.`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"$q2", "[", "t", "]"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", "2.`"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"2.`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"1.`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"$q1", "[", "t", "]"}]}], "-", 
        RowBox[{"1.`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"$q3", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"$q2", "[", "t", "]"}]}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.753273549197754*^9},
 CellLabel->
  "Out[280]//MatrixForm=",ExpressionUUID->"bf5c1ef0-2edd-420d-a415-\
01e8145edf83"]
}, Open  ]]
},
WindowSize->{1195, 963},
WindowMargins->{{Automatic, 64}, {-254, Automatic}},
Magnification->1.5,
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 468, 7, 47, "Input",ExpressionUUID->"6799d7ae-1d61-46dc-bb78-f273d45a672a"],
Cell[1051, 31, 644, 13, 76, "Output",ExpressionUUID->"0458b4a3-c37d-40a5-8049-368961c2ed78"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1732, 49, 315, 5, 47, "Input",ExpressionUUID->"9b5cbfb0-a1b2-493d-afbd-773d24a5ea3e"],
Cell[2050, 56, 446, 10, 76, "Output",ExpressionUUID->"b74cfdc6-3d33-46bb-8207-eb5a5f5ece20"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2533, 71, 301, 6, 47, "Input",ExpressionUUID->"04613cca-770c-4966-8a56-83fe55400a42"],
Cell[2837, 79, 441, 10, 33, "Message",ExpressionUUID->"003cda68-f656-48fa-b51f-7fc748ca7fee"],
Cell[3281, 91, 394, 9, 76, "Output",ExpressionUUID->"d39d7b35-b635-4aa6-ac9c-0f5dd02e2e3c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3712, 105, 113, 1, 47, "Input",ExpressionUUID->"c68fa186-57de-419b-a800-de459d083f95"],
Cell[3828, 108, 230, 3, 53, "Output",ExpressionUUID->"04b6f785-faaa-4989-9b7d-4b6ccea29839"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4095, 116, 497, 9, 47, "Input",ExpressionUUID->"d3752458-8680-41fc-bfdd-442d13278103"],
Cell[4595, 127, 565, 14, 75, "Output",ExpressionUUID->"6a5eb656-e22f-4887-a5b7-0eb9f00e026c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5197, 146, 200, 4, 47, "Input",ExpressionUUID->"be92e993-f061-461f-be53-ae5d8181986d"],
Cell[5400, 152, 153, 3, 76, "Output",ExpressionUUID->"0e5d59c1-a3e1-4694-b936-7c4b62d49e96"]
}, Open  ]],
Cell[5568, 158, 227, 4, 47, "Input",ExpressionUUID->"269105b2-d3a7-49d4-aba4-5e2d6421f209"],
Cell[5798, 164, 147, 3, 82, "Input",ExpressionUUID->"96d0ef26-c1c6-40cf-930c-ae1ea361bf41"],
Cell[CellGroupData[{
Cell[5970, 171, 886, 23, 150, "Input",ExpressionUUID->"3bea0739-b28a-4967-8be4-efbed6b6e26c"],
Cell[6859, 196, 179, 3, 76, "Output",ExpressionUUID->"da616266-adbe-4755-99c6-07c52f99a343"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7075, 204, 152, 3, 47, "Input",ExpressionUUID->"1af57f4a-749e-438e-83a9-b3157f4ffe30"],
Cell[7230, 209, 357, 6, 76, "Output",ExpressionUUID->"829b8e23-9dd6-416d-88cf-926648ef2211"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7624, 220, 212, 5, 47, "Input",ExpressionUUID->"6976f7ed-d55c-40e2-8a85-ac38c807baf0"],
Cell[7839, 227, 424, 10, 33, "Message",ExpressionUUID->"b3236b09-33fa-44e5-899e-8ed89dc46843"],
Cell[8266, 239, 297, 6, 53, "Output",ExpressionUUID->"db2ffa1f-ee31-414b-94c6-6154f735e785"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8600, 250, 319, 6, 47, "Input",ExpressionUUID->"6b4079d3-a223-4e38-b465-d74920e70c6b"],
Cell[8922, 258, 4658, 135, 463, "Output",ExpressionUUID->"bf5c1ef0-2edd-420d-a415-01e8145edf83"]
}, Open  ]]
}
]
*)

