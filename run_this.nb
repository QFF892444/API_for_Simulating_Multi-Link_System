(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     34427,        732]
NotebookOptionsPosition[     32232,        690]
NotebookOutlinePosition[     32584,        706]
CellTagsIndexPosition[     32541,        703]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{"ME314", " ", "Final", " ", "Project"}], ";"}],
  FontSize->16,
  FontColor->RGBColor[0.5, 0, 0.5]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"FeiyuChen", ";"}],
  FontSize->16,
  FontColor->RGBColor[0.5, 0, 0.5]], "\[IndentingNewLine]", 
 RowBox[{"Scene2", 
  StyleBox[";",
   FontSize->16,
   FontColor->RGBColor[0.5, 0, 0.5]]}]}], "Input",
 CellChangeTimes->{{3.753309178661083*^9, 3.753309235342437*^9}, {
  3.753310159012438*^9, 3.7533101871409063`*^9}, {3.7537486499407187`*^9, 
  3.753748681741654*^9}},ExpressionUUID->"44404319-de98-4c38-a602-\
c0951d2db6ec"],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.753308380956698*^9, 3.753308414702188*^9}, {
  3.7533084812988586`*^9, 3.753308494172968*^9}, {3.753310136220323*^9, 
  3.753310151677449*^9}, {3.753310195085279*^9, 3.753310195283207*^9}, {
  3.753317553534202*^9, 3.753317560242825*^9}, {3.75332250569803*^9, 
  3.753322513604748*^9}, {3.7533276696193457`*^9, 3.753327671664198*^9}, {
  3.753465922979494*^9, 3.753465945042613*^9}, {3.753468111960958*^9, 
  3.7534681171168127`*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"d53147a6-be5d-4859-9bc8-5ed97a69a79c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"-", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Open", " ", "and", " ", "run", " ", "library", " ", "scripts"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myOpenFile", "[", "filename_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "nb1", "}"}], ",", 
      RowBox[{
       RowBox[{"nb1", "=", 
        RowBox[{"NotebookOpen", "[", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</\>\"", "<>", 
          "filename"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"SelectionMove", "[", 
        RowBox[{"nb1", ",", "All", ",", "Notebook"}], "]"}], ";", "\n", 
       "     ", 
       RowBox[{"SelectionEvaluate", "[", "nb1", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"myOpenFile", "[", "\"\<./lib/funcs_math.nb\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"myOpenFile", "[", "\"\<./lib/funcs_assist.nb\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"myOpenFile", "[", "\"\<./lib/funcs_main.nb\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{" ", 
     RowBox[{"!!", 
      RowBox[{"!!", 
       RowBox[{"!!", 
        RowBox[{"!!", 
         RowBox[{"!", " ", 
          RowBox[{
          "wait", " ", "for", " ", "1", " ", "second", " ", "before", " ", 
           "running", " ", "the", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"following", " ", "!!"}], "!!"}], "!"}]}]}]}]}]}]}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.753308380956698*^9, 3.753308414702188*^9}, {
  3.7533084812988586`*^9, 3.753308494172968*^9}, {3.753310136220323*^9, 
  3.753310151677449*^9}, {3.753310195085279*^9, 3.753310195283207*^9}, {
  3.753317553534202*^9, 3.753317560242825*^9}, {3.75332250569803*^9, 
  3.753322513604748*^9}, {3.7533276696193457`*^9, 3.753327671664198*^9}, {
  3.753465922979494*^9, 3.753465945042613*^9}, {3.753468111960958*^9, 
  3.7534681171168127`*^9}, {3.7537485914891977`*^9, 3.753748595101036*^9}, {
  3.7539848309230013`*^9, 3.7539848392597857`*^9}, {3.753985379435153*^9, 
  3.753985386353973*^9}, {3.753985419714218*^9, 3.753985434394663*^9}},
 EmphasizeSyntaxErrors->
  True,ExpressionUUID->"c5bd22c0-e044-4e47-8284-d1c5b986a01f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"-", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Choose", " ", "a", " ", "scene"}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"myOpenFile", "[", "\"\<./scenes/scene2.nb\>\"", "]"}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.7539853899120407`*^9, 
  3.753985437017158*^9}},ExpressionUUID->"e17f498d-a57f-4eb4-a89e-\
3400996a0e75"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"-", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Set", " ", "up", " ", "all", " ", "things"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"mainResetVars", ";"}], "\[IndentingNewLine]", 
   RowBox[{"CreateObjects", ";"}], "\[IndentingNewLine]", 
   RowBox[{"RemoveDuplicateVertexs", ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"externalForces", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "nVars"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<\\nStart Solving ...\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"mainSolveELeqs", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Finish Solving ...\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ddqSolve", "=", 
     RowBox[{"TurnToEq", "[", 
      RowBox[{"ddqs", ",", 
       RowBox[{"EQ", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", ";;", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<\\nStart setting impact ...\>\"", "]"}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetUpImpacts", "[", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Finish setting impact ...\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.753308565222193*^9, 3.753308611214097*^9}, {
   3.753308672890251*^9, 3.75330868069359*^9}, 3.7533089094793873`*^9, {
   3.753308953413175*^9, 3.753308954433732*^9}, {3.753308996498398*^9, 
   3.7533090000055447`*^9}, {3.753309139053328*^9, 3.753309142828926*^9}, 
   3.7533097892441072`*^9, {3.753311671624669*^9, 3.7533116717295437`*^9}, {
   3.753312240546194*^9, 3.7533122441131268`*^9}, {3.753317574018428*^9, 
   3.753317586952054*^9}, {3.753317634865655*^9, 3.753317645113809*^9}, {
   3.7533245618722258`*^9, 3.7533245621566477`*^9}, {3.753327948926567*^9, 
   3.753327955616474*^9}, {3.753329371995064*^9, 3.7533294200291767`*^9}, {
   3.753985429972849*^9, 
   3.753985438267434*^9}},ExpressionUUID->"d838a9b1-f608-43fd-8306-\
389a6cd4fb0f"],

Cell[CellGroupData[{

Cell[BoxData["\<\"\\nStart Solving ...\"\>"], "Print",
 CellChangeTimes->{
  3.753317722711606*^9, 3.753317854784171*^9, 3.7533179740587387`*^9, 
   3.7533181457170553`*^9, 3.753318498087888*^9, {3.7533185663471403`*^9, 
   3.753318583137595*^9}, 3.753318622526113*^9, 3.753318785945004*^9, 
   3.753318981218894*^9, 3.753319185633382*^9, 3.753319887358015*^9, 
   3.753319961190015*^9, 3.753322649328223*^9, 3.7533232874425488`*^9, 
   3.753323604347797*^9, 3.753323933881208*^9, 3.753324199360199*^9, 
   3.753324419083968*^9, 3.7533246254069843`*^9, 3.753324701555211*^9, 
   3.753324963539143*^9, 3.753325055432644*^9, 3.7533261150527573`*^9, 
   3.753326649337582*^9, 3.7533272615550413`*^9, {3.7534658944548397`*^9, 
   3.753465912346718*^9}, 3.753465997092472*^9, 3.753467912237815*^9, 
   3.753468130033476*^9, 3.7534682651281548`*^9, 3.7534685890483227`*^9, 
   3.7534687508236856`*^9, 3.7534688421105347`*^9, 3.753468924882324*^9, 
   3.753469350347578*^9, 3.753469877147727*^9, 3.753646620469323*^9, 
   3.753746438519763*^9, 3.7537474367422867`*^9, 3.753747688938023*^9, 
   3.753747871406384*^9, 3.753748084578553*^9, 3.753748368621798*^9, 
   3.753748986750244*^9, 3.7537491158013563`*^9, 3.753749278428071*^9, 
   3.753749347036851*^9, 3.753749417068581*^9, 3.75374954088588*^9, 
   3.753749735549737*^9, 3.7537498232378817`*^9, 3.753749895058195*^9, {
   3.753750095149405*^9, 3.753750120228181*^9}, 3.753752147666264*^9, 
   3.7537528435340023`*^9, 3.753753022366137*^9, 3.753753053216164*^9, 
   3.7537531193635693`*^9, 3.75375323330063*^9, 3.753753450865219*^9, 
   3.753753559712166*^9, 3.753753628667182*^9, 3.753984963586464*^9},
 CellLabel->
  "During evaluation of \
In[72]:=",ExpressionUUID->"c60cc9f3-e4e5-42ce-8943-e426c0685912"],

Cell[BoxData["\<\"Finish Solving ...\"\>"], "Print",
 CellChangeTimes->{
  3.753317722711606*^9, 3.753317854784171*^9, 3.7533179740587387`*^9, 
   3.7533181457170553`*^9, 3.753318498087888*^9, {3.7533185663471403`*^9, 
   3.753318583137595*^9}, 3.753318622526113*^9, 3.753318785945004*^9, 
   3.753318981218894*^9, 3.753319185633382*^9, 3.753319887358015*^9, 
   3.753319961190015*^9, 3.753322649328223*^9, 3.7533232874425488`*^9, 
   3.753323604347797*^9, 3.753323933881208*^9, 3.753324199360199*^9, 
   3.753324419083968*^9, 3.7533246254069843`*^9, 3.753324701555211*^9, 
   3.753324963539143*^9, 3.753325055432644*^9, 3.7533261150527573`*^9, 
   3.753326649337582*^9, 3.7533272615550413`*^9, {3.7534658944548397`*^9, 
   3.753465912346718*^9}, 3.753465997092472*^9, 3.753467912237815*^9, 
   3.753468130033476*^9, 3.7534682651281548`*^9, 3.7534685890483227`*^9, 
   3.7534687508236856`*^9, 3.7534688421105347`*^9, 3.753468924882324*^9, 
   3.753469350347578*^9, 3.753469877147727*^9, 3.753646620469323*^9, 
   3.753746438519763*^9, 3.7537474367422867`*^9, 3.753747688938023*^9, 
   3.753747871406384*^9, 3.753748084578553*^9, 3.753748368621798*^9, 
   3.753748986750244*^9, 3.7537491158013563`*^9, 3.753749278428071*^9, 
   3.753749347036851*^9, 3.753749417068581*^9, 3.75374954088588*^9, 
   3.753749735549737*^9, 3.7537498232378817`*^9, 3.753749895058195*^9, {
   3.753750095149405*^9, 3.753750120228181*^9}, 3.753752147666264*^9, 
   3.7537528435340023`*^9, 3.753753022366137*^9, 3.753753053216164*^9, 
   3.7537531193635693`*^9, 3.75375323330063*^9, 3.753753450865219*^9, 
   3.753753559712166*^9, 3.753753628667182*^9, 3.7539849638368053`*^9},
 CellLabel->
  "During evaluation of \
In[72]:=",ExpressionUUID->"11880466-99fc-4a01-8107-51c463fa8732"],

Cell[BoxData["\<\"\\nStart setting impact ...\"\>"], "Print",
 CellChangeTimes->{
  3.753317722711606*^9, 3.753317854784171*^9, 3.7533179740587387`*^9, 
   3.7533181457170553`*^9, 3.753318498087888*^9, {3.7533185663471403`*^9, 
   3.753318583137595*^9}, 3.753318622526113*^9, 3.753318785945004*^9, 
   3.753318981218894*^9, 3.753319185633382*^9, 3.753319887358015*^9, 
   3.753319961190015*^9, 3.753322649328223*^9, 3.7533232874425488`*^9, 
   3.753323604347797*^9, 3.753323933881208*^9, 3.753324199360199*^9, 
   3.753324419083968*^9, 3.7533246254069843`*^9, 3.753324701555211*^9, 
   3.753324963539143*^9, 3.753325055432644*^9, 3.7533261150527573`*^9, 
   3.753326649337582*^9, 3.7533272615550413`*^9, {3.7534658944548397`*^9, 
   3.753465912346718*^9}, 3.753465997092472*^9, 3.753467912237815*^9, 
   3.753468130033476*^9, 3.7534682651281548`*^9, 3.7534685890483227`*^9, 
   3.7534687508236856`*^9, 3.7534688421105347`*^9, 3.753468924882324*^9, 
   3.753469350347578*^9, 3.753469877147727*^9, 3.753646620469323*^9, 
   3.753746438519763*^9, 3.7537474367422867`*^9, 3.753747688938023*^9, 
   3.753747871406384*^9, 3.753748084578553*^9, 3.753748368621798*^9, 
   3.753748986750244*^9, 3.7537491158013563`*^9, 3.753749278428071*^9, 
   3.753749347036851*^9, 3.753749417068581*^9, 3.75374954088588*^9, 
   3.753749735549737*^9, 3.7537498232378817`*^9, 3.753749895058195*^9, {
   3.753750095149405*^9, 3.753750120228181*^9}, 3.753752147666264*^9, 
   3.7537528435340023`*^9, 3.753753022366137*^9, 3.753753053216164*^9, 
   3.7537531193635693`*^9, 3.75375323330063*^9, 3.753753450865219*^9, 
   3.753753559712166*^9, 3.753753628667182*^9, 3.753984963838313*^9},
 CellLabel->
  "During evaluation of \
In[72]:=",ExpressionUUID->"158ea2ff-8e37-4a04-be7e-8f36ee5d6cf7"],

Cell[BoxData["\<\"Finish setting impact ...\"\>"], "Print",
 CellChangeTimes->{
  3.753317722711606*^9, 3.753317854784171*^9, 3.7533179740587387`*^9, 
   3.7533181457170553`*^9, 3.753318498087888*^9, {3.7533185663471403`*^9, 
   3.753318583137595*^9}, 3.753318622526113*^9, 3.753318785945004*^9, 
   3.753318981218894*^9, 3.753319185633382*^9, 3.753319887358015*^9, 
   3.753319961190015*^9, 3.753322649328223*^9, 3.7533232874425488`*^9, 
   3.753323604347797*^9, 3.753323933881208*^9, 3.753324199360199*^9, 
   3.753324419083968*^9, 3.7533246254069843`*^9, 3.753324701555211*^9, 
   3.753324963539143*^9, 3.753325055432644*^9, 3.7533261150527573`*^9, 
   3.753326649337582*^9, 3.7533272615550413`*^9, {3.7534658944548397`*^9, 
   3.753465912346718*^9}, 3.753465997092472*^9, 3.753467912237815*^9, 
   3.753468130033476*^9, 3.7534682651281548`*^9, 3.7534685890483227`*^9, 
   3.7534687508236856`*^9, 3.7534688421105347`*^9, 3.753468924882324*^9, 
   3.753469350347578*^9, 3.753469877147727*^9, 3.753646620469323*^9, 
   3.753746438519763*^9, 3.7537474367422867`*^9, 3.753747688938023*^9, 
   3.753747871406384*^9, 3.753748084578553*^9, 3.753748368621798*^9, 
   3.753748986750244*^9, 3.7537491158013563`*^9, 3.753749278428071*^9, 
   3.753749347036851*^9, 3.753749417068581*^9, 3.75374954088588*^9, 
   3.753749735549737*^9, 3.7537498232378817`*^9, 3.753749895058195*^9, {
   3.753750095149405*^9, 3.753750120228181*^9}, 3.753752147666264*^9, 
   3.7537528435340023`*^9, 3.753753022366137*^9, 3.753753053216164*^9, 
   3.7537531193635693`*^9, 3.75375323330063*^9, 3.753753450865219*^9, 
   3.753753559712166*^9, 3.753753628667182*^9, 3.75398496440302*^9},
 CellLabel->
  "During evaluation of \
In[72]:=",ExpressionUUID->"133bd9c6-6b05-4f56-bc4d-8765bc02aa5c"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Set", " ", "up", " ", "params", " ", "for", " ", "NDSolve"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SetUpImpactEvents", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timeend", "=", "10"}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{"total", " ", "simulation", " ", "time"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"MAXIMPACTTIMES", "=", "10000"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"impactDetectionError", "=", "0.05"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"intergrationMaxStepSize", "=", "0.001"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ifprint", "=", "False"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.753308556953918*^9, 3.753308577232242*^9}, {
   3.753308684669465*^9, 3.753308685036993*^9}, {3.75330912793821*^9, 
   3.753309162723496*^9}, {3.753309840047456*^9, 3.753309855888073*^9}, {
   3.753312429834916*^9, 3.7533124320520144`*^9}, {3.753317634014289*^9, 
   3.75331764775286*^9}, {3.753317746537962*^9, 3.753317746822007*^9}, 
   3.753318007340899*^9, {3.753319048542008*^9, 3.7533190498157263`*^9}, {
   3.7533191751633453`*^9, 3.753319177177394*^9}, {3.753319794499786*^9, 
   3.753319794703724*^9}, {3.7533203142558813`*^9, 3.753320335807131*^9}, {
   3.7533203691242313`*^9, 3.753320369216901*^9}, {3.753320446820445*^9, 
   3.753320447318694*^9}, {3.753320654596387*^9, 3.753320654869029*^9}, {
   3.753320864228092*^9, 3.753320864460444*^9}, {3.753324526339973*^9, 
   3.753324594764461*^9}, 3.753326139859495*^9, {3.7533266466319313`*^9, 
   3.75332666407509*^9}, 3.753329438483163*^9, 3.753466047848481*^9, {
   3.753466449916313*^9, 3.753466454064052*^9}, {3.753466662365604*^9, 
   3.753466662450489*^9}, 3.753466748062128*^9, {3.753467085012994*^9, 
   3.7534670851079693`*^9}, {3.7534692590478477`*^9, 
   3.7534692609239073`*^9}, {3.7536466237434797`*^9, 3.753646624020008*^9}, 
   3.753748083275393*^9, 3.753748152645279*^9, {3.753749038545282*^9, 
   3.753749060557453*^9}, 3.753749767607473*^9, {3.75374991737164*^9, 
   3.75374994004021*^9}, {3.75375006579742*^9, 3.753750068127758*^9}, 
   3.753750174709489*^9, {3.7537502591334667`*^9, 3.7537502593839083`*^9}, {
   3.753750290617277*^9, 3.753750319503709*^9}, 3.753753056331522*^9, {
   3.753753323438161*^9, 3.753753325992326*^9}, {3.753984948645686*^9, 
   3.753984979692975*^9}, {3.753985080851563*^9, 3.753985103094084*^9}, {
   3.753985158544715*^9, 3.753985165418462*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"bba9cd65-ac4f-41df-b71c-9ad58c33fcef"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"NDsolve", " ", "and", " ", "Play", " ", "simulation"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"end", ",", "data", ",", "bounces"}], "}"}], "=", 
    RowBox[{"mainNDSolveSimulation", "[", 
     RowBox[{"qsInit", ",", "dqsInit"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.753308556953918*^9, 3.753308577232242*^9}, {
   3.753308684669465*^9, 3.753308685036993*^9}, {3.75330912793821*^9, 
   3.753309162723496*^9}, {3.753309840047456*^9, 3.753309855888073*^9}, {
   3.753312429834916*^9, 3.7533124320520144`*^9}, {3.753317634014289*^9, 
   3.75331764775286*^9}, {3.753317746537962*^9, 3.753317746822007*^9}, 
   3.753318007340899*^9, {3.753319048542008*^9, 3.7533190498157263`*^9}, {
   3.7533191751633453`*^9, 3.753319177177394*^9}, {3.753319794499786*^9, 
   3.753319794703724*^9}, {3.7533203142558813`*^9, 3.753320335807131*^9}, {
   3.7533203691242313`*^9, 3.753320369216901*^9}, {3.753320446820445*^9, 
   3.753320447318694*^9}, {3.753320654596387*^9, 3.753320654869029*^9}, {
   3.753320864228092*^9, 3.753320864460444*^9}, {3.753324526339973*^9, 
   3.753324594764461*^9}, 3.753326139859495*^9, {3.7533266466319313`*^9, 
   3.75332666407509*^9}, 3.753329438483163*^9, 3.753466047848481*^9, {
   3.753466449916313*^9, 3.753466454064052*^9}, {3.753466662365604*^9, 
   3.753466662450489*^9}, 3.753466748062128*^9, {3.753467085012994*^9, 
   3.7534670851079693`*^9}, {3.7534692590478477`*^9, 
   3.7534692609239073`*^9}, {3.7536466237434797`*^9, 3.753646624020008*^9}, 
   3.753748083275393*^9, 3.753748152645279*^9, {3.753749038545282*^9, 
   3.753749060557453*^9}, 3.753749767607473*^9, {3.75374991737164*^9, 
   3.75374994004021*^9}, {3.75375006579742*^9, 3.753750068127758*^9}, 
   3.753750174709489*^9, {3.7537502591334667`*^9, 3.7537502593839083`*^9}, {
   3.753750290617277*^9, 3.753750319503709*^9}, 3.753753056331522*^9, {
   3.753753323438161*^9, 3.753753325992326*^9}, {3.753984948645686*^9, 
   3.753984950442459*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"6815ff44-fe72-4a3f-adab-e63cc55c1490"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Computing simulation: \"\>", "\[InvisibleSpace]", 
   "2.35685705488522`", "\[InvisibleSpace]", "\<\" / \"\>", 
   "\[InvisibleSpace]", "10", "\[InvisibleSpace]", "\<\" ...\"\>"}],
  SequenceForm["Computing simulation: ", 2.35685705488522, " / ", 10, " ..."],
  
  Editable->False]], "Print",
 CellChangeTimes->{
  3.753749774032135*^9, 3.753749829609284*^9, {3.753749899612137*^9, 
   3.753749944081505*^9}, {3.753750068976912*^9, 3.7537501211979856`*^9}, 
   3.753750178466969*^9, 3.753750263337091*^9, {3.753750294911044*^9, 
   3.753750323462512*^9}, {3.753752153068221*^9, 3.753752181938134*^9}, 
   3.753752848392026*^9, 3.753753069797804*^9, 3.753753136532748*^9, 
   3.753753239693931*^9, 3.753753331335066*^9, 3.7537534605700417`*^9, 
   3.753753567185027*^9, 3.7537536362313967`*^9, {3.753984976852066*^9, 
   3.753984996408123*^9}, {3.753985083074458*^9, 3.753985106679755*^9}, 
   3.7539851803725967`*^9},
 CellLabel->
  "During evaluation of \
In[149]:=",ExpressionUUID->"b95e57bd-18ea-48d2-af29-b7c006051ec6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Computing simulation: \"\>", "\[InvisibleSpace]", 
   "4.0183995543278535`", "\[InvisibleSpace]", "\<\" / \"\>", 
   "\[InvisibleSpace]", "10", "\[InvisibleSpace]", "\<\" ...\"\>"}],
  SequenceForm[
  "Computing simulation: ", 4.0183995543278535`, " / ", 10, " ..."],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.753749774032135*^9, 3.753749829609284*^9, {3.753749899612137*^9, 
   3.753749944081505*^9}, {3.753750068976912*^9, 3.7537501211979856`*^9}, 
   3.753750178466969*^9, 3.753750263337091*^9, {3.753750294911044*^9, 
   3.753750323462512*^9}, {3.753752153068221*^9, 3.753752181938134*^9}, 
   3.753752848392026*^9, 3.753753069797804*^9, 3.753753136532748*^9, 
   3.753753239693931*^9, 3.753753331335066*^9, 3.7537534605700417`*^9, 
   3.753753567185027*^9, 3.7537536362313967`*^9, {3.753984976852066*^9, 
   3.753984996408123*^9}, {3.753985083074458*^9, 3.753985106679755*^9}, 
   3.753985190489139*^9},
 CellLabel->
  "During evaluation of \
In[149]:=",ExpressionUUID->"1e04edc3-8e0e-4176-bb4a-48eee2716f84"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Computing simulation: \"\>", "\[InvisibleSpace]", 
   "6.230852551236403`", "\[InvisibleSpace]", "\<\" / \"\>", 
   "\[InvisibleSpace]", "10", "\[InvisibleSpace]", "\<\" ...\"\>"}],
  SequenceForm["Computing simulation: ", 6.230852551236403, " / ", 10, " ..."],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.753749774032135*^9, 3.753749829609284*^9, {3.753749899612137*^9, 
   3.753749944081505*^9}, {3.753750068976912*^9, 3.7537501211979856`*^9}, 
   3.753750178466969*^9, 3.753750263337091*^9, {3.753750294911044*^9, 
   3.753750323462512*^9}, {3.753752153068221*^9, 3.753752181938134*^9}, 
   3.753752848392026*^9, 3.753753069797804*^9, 3.753753136532748*^9, 
   3.753753239693931*^9, 3.753753331335066*^9, 3.7537534605700417`*^9, 
   3.753753567185027*^9, 3.7537536362313967`*^9, {3.753984976852066*^9, 
   3.753984996408123*^9}, {3.753985083074458*^9, 3.753985106679755*^9}, 
   3.753985205736882*^9},
 CellLabel->
  "During evaluation of \
In[149]:=",ExpressionUUID->"9ad62335-0beb-4b5f-8d26-fdc2aa053e77"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Computing simulation: \"\>", "\[InvisibleSpace]", 
   "8.366380238265599`", "\[InvisibleSpace]", "\<\" / \"\>", 
   "\[InvisibleSpace]", "10", "\[InvisibleSpace]", "\<\" ...\"\>"}],
  SequenceForm["Computing simulation: ", 8.366380238265599, " / ", 10, " ..."],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.753749774032135*^9, 3.753749829609284*^9, {3.753749899612137*^9, 
   3.753749944081505*^9}, {3.753750068976912*^9, 3.7537501211979856`*^9}, 
   3.753750178466969*^9, 3.753750263337091*^9, {3.753750294911044*^9, 
   3.753750323462512*^9}, {3.753752153068221*^9, 3.753752181938134*^9}, 
   3.753752848392026*^9, 3.753753069797804*^9, 3.753753136532748*^9, 
   3.753753239693931*^9, 3.753753331335066*^9, 3.7537534605700417`*^9, 
   3.753753567185027*^9, 3.7537536362313967`*^9, {3.753984976852066*^9, 
   3.753984996408123*^9}, {3.753985083074458*^9, 3.753985106679755*^9}, 
   3.753985219188225*^9},
 CellLabel->
  "During evaluation of \
In[149]:=",ExpressionUUID->"9dd5f841-d514-4fe3-88a6-0fdda21b00b7"],

Cell[BoxData["\<\"Not an impact\"\>"], "Print",
 CellChangeTimes->{
  3.753749774032135*^9, 3.753749829609284*^9, {3.753749899612137*^9, 
   3.753749944081505*^9}, {3.753750068976912*^9, 3.7537501211979856`*^9}, 
   3.753750178466969*^9, 3.753750263337091*^9, {3.753750294911044*^9, 
   3.753750323462512*^9}, {3.753752153068221*^9, 3.753752181938134*^9}, 
   3.753752848392026*^9, 3.753753069797804*^9, 3.753753136532748*^9, 
   3.753753239693931*^9, 3.753753331335066*^9, 3.7537534605700417`*^9, 
   3.753753567185027*^9, 3.7537536362313967`*^9, {3.753984976852066*^9, 
   3.753984996408123*^9}, {3.753985083074458*^9, 3.753985106679755*^9}, 
   3.753985230395115*^9},
 CellLabel->
  "During evaluation of \
In[149]:=",ExpressionUUID->"785e3780-396b-473c-91a9-0c0f1d082c4d"],

Cell[BoxData["\<\"Computing simulation is completed.\"\>"], "Print",
 CellChangeTimes->{
  3.753749774032135*^9, 3.753749829609284*^9, {3.753749899612137*^9, 
   3.753749944081505*^9}, {3.753750068976912*^9, 3.7537501211979856`*^9}, 
   3.753750178466969*^9, 3.753750263337091*^9, {3.753750294911044*^9, 
   3.753750323462512*^9}, {3.753752153068221*^9, 3.753752181938134*^9}, 
   3.753752848392026*^9, 3.753753069797804*^9, 3.753753136532748*^9, 
   3.753753239693931*^9, 3.753753331335066*^9, 3.7537534605700417`*^9, 
   3.753753567185027*^9, 3.7537536362313967`*^9, {3.753984976852066*^9, 
   3.753984996408123*^9}, {3.753985083074458*^9, 3.753985106679755*^9}, 
   3.753985230396205*^9},
 CellLabel->
  "During evaluation of \
In[149]:=",ExpressionUUID->"d5b7d16e-264e-4017-8d61-1fbaa48fe03d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Plot", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plotVariablesValues", ";"}], "\[IndentingNewLine]", 
   RowBox[{"plotHamValues", ";", 
    RowBox[{"(*", 
     RowBox[{
     "Remove", " ", "the", " ", "semicolon", " ", "to", " ", "plot", " ", 
      "Hamiltonian", " ", "and", " ", 
      RowBox[{"Vars", "."}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"plotAnimation", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2.5"}], ",", "2.5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "1"}], "}"}]}], "}"}], "]"}]}]}]}]], "Input",\

 CellChangeTimes->{{3.753308556953918*^9, 3.753308577232242*^9}, {
   3.753308684669465*^9, 3.753308685036993*^9}, {3.75330912793821*^9, 
   3.753309162723496*^9}, {3.753309840047456*^9, 3.753309855888073*^9}, {
   3.753312429834916*^9, 3.7533124320520144`*^9}, {3.753317634014289*^9, 
   3.75331764775286*^9}, {3.753317746537962*^9, 3.753317746822007*^9}, 
   3.753318007340899*^9, {3.753319048542008*^9, 3.7533190498157263`*^9}, {
   3.7533191751633453`*^9, 3.753319177177394*^9}, {3.753319794499786*^9, 
   3.753319794703724*^9}, {3.7533203142558813`*^9, 3.753320335807131*^9}, {
   3.7533203691242313`*^9, 3.753320369216901*^9}, {3.753320446820445*^9, 
   3.753320447318694*^9}, {3.753320654596387*^9, 3.753320654869029*^9}, {
   3.753320864228092*^9, 3.753320864460444*^9}, {3.753324526339973*^9, 
   3.753324594764461*^9}, 3.753326139859495*^9, {3.7533266466319313`*^9, 
   3.75332666407509*^9}, 3.753329438483163*^9, 3.753466047848481*^9, {
   3.753466449916313*^9, 3.753466454064052*^9}, {3.753466662365604*^9, 
   3.753466662450489*^9}, 3.753466748062128*^9, {3.753467085012994*^9, 
   3.7534670851079693`*^9}, {3.7534692590478477`*^9, 
   3.7534692609239073`*^9}, {3.7536466237434797`*^9, 3.753646624020008*^9}, 
   3.753748083275393*^9, 3.753748152645279*^9, {3.753749038545282*^9, 
   3.753749060557453*^9}, {3.753749138230472*^9, 3.753749140874048*^9}, {
   3.7537492083583937`*^9, 3.753749216801887*^9}, {3.753750124342456*^9, 
   3.7537501604591217`*^9}, {3.7537509394485207`*^9, 3.753750980557629*^9}, {
   3.753751232006172*^9, 3.753751234736335*^9}, {3.753985062006345*^9, 
   3.753985073569663*^9}, {3.753985177974321*^9, 3.753985211330346*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"81adfd1e-edc8-40d0-a533-430ae1c36c3f"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`t$$ = 8.74081160639039, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`t$$], 0, 10}}, Typeset`size$$ = {720., {290., 301.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`t$46529$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`t$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`t$$, $CellContext`t$46529$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[{
         Graphics[{
           Thickness[$CellContext`impactDetectionError/8], 
           $CellContext`LinksForAnimation[$CellContext`t$$]}], 
         Graphics[{
           PointSize[0.02], 
           $CellContext`pointsForAnimation[$CellContext`t$$]}]}, 
        PlotRange -> {{-2.5, 2.5}, {-3, 1}}, Frame -> True], 
      "Specifications" :> {{$CellContext`t$$, 0, 10, AnimationRate -> 1, 
         AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{806., {357., 369.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.75398504901615*^9, 3.753985073871551*^9}, 
   3.7539851137586*^9, 3.7539852350177517`*^9},
 CellLabel->
  "Out[151]=",ExpressionUUID->"19007589-e36f-41f3-b558-2e09e19161a6"]
}, Open  ]]
},
WindowSize->{1920, 960},
WindowMargins->{{0, Automatic}, {0, Automatic}},
Magnification->2.,
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 619, 17, 150, "Input",ExpressionUUID->"44404319-de98-4c38-a602-c0951d2db6ec"],
Cell[1180, 39, 592, 10, 60, "Input",ExpressionUUID->"d53147a6-be5d-4859-9bc8-5ed97a69a79c"],
Cell[1775, 51, 3272, 86, 448, "Input",ExpressionUUID->"c5bd22c0-e044-4e47-8284-d1c5b986a01f"],
Cell[5050, 139, 1314, 41, 147, "Input",ExpressionUUID->"e17f498d-a57f-4eb4-a89e-3400996a0e75"],
Cell[CellGroupData[{
Cell[6389, 184, 3200, 80, 792, "Input",ExpressionUUID->"d838a9b1-f608-43fd-8306-389a6cd4fb0f"],
Cell[CellGroupData[{
Cell[9614, 268, 1756, 26, 89, "Print",ExpressionUUID->"c60cc9f3-e4e5-42ce-8943-e426c0685912"],
Cell[11373, 296, 1756, 26, 48, "Print",ExpressionUUID->"11880466-99fc-4a01-8107-51c463fa8732"],
Cell[13132, 324, 1763, 26, 89, "Print",ExpressionUUID->"158ea2ff-8e37-4a04-be7e-8f36ee5d6cf7"],
Cell[14898, 352, 1760, 26, 48, "Print",ExpressionUUID->"133bd9c6-6b05-4f56-bc4d-8765bc02aa5c"]
}, Open  ]]
}, Open  ]],
Cell[16685, 382, 2603, 46, 348, "Input",ExpressionUUID->"bba9cd65-ac4f-41df-b71c-9ad58c33fcef"],
Cell[CellGroupData[{
Cell[19313, 432, 2138, 36, 133, "Input",ExpressionUUID->"6815ff44-fe72-4a3f-adab-e63cc55c1490"],
Cell[CellGroupData[{
Cell[21476, 472, 1072, 20, 48, "Print",ExpressionUUID->"b95e57bd-18ea-48d2-af29-b7c006051ec6"],
Cell[22551, 494, 1075, 20, 48, "Print",ExpressionUUID->"1e04edc3-8e0e-4176-bb4a-48eee2716f84"],
Cell[23629, 516, 1069, 19, 48, "Print",ExpressionUUID->"9ad62335-0beb-4b5f-8d26-fdc2aa053e77"],
Cell[24701, 537, 1069, 19, 48, "Print",ExpressionUUID->"9dd5f841-d514-4fe3-88a6-0fdda21b00b7"],
Cell[25773, 558, 776, 13, 48, "Print",ExpressionUUID->"785e3780-396b-473c-91a9-0c0f1d082c4d"],
Cell[26552, 573, 797, 13, 48, "Print",ExpressionUUID->"d5b7d16e-264e-4017-8d61-1fbaa48fe03d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27398, 592, 2442, 45, 219, "Input",ExpressionUUID->"81adfd1e-edc8-40d0-a533-430ae1c36c3f"],
Cell[29843, 639, 2373, 48, 791, "Output",ExpressionUUID->"19007589-e36f-41f3-b558-2e09e19161a6"]
}, Open  ]]
}
]
*)

