(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     36397,        802]
NotebookOptionsPosition[     34113,        759]
NotebookOutlinePosition[     34465,        775]
CellTagsIndexPosition[     34422,        772]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{"ME314", " ", "Final", " ", "Project"}], ";"}],
  FontSize->16,
  FontColor->RGBColor[0.5, 0, 0.5]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"FeiyuChen", ";"}],
  FontSize->16,
  FontColor->RGBColor[0.5, 0, 0.5]]}], "Input",
 CellChangeTimes->{{3.753309178661083*^9, 3.753309235342437*^9}, {
  3.753310159012438*^9, 3.7533101871409063`*^9}, {3.7537486499407187`*^9, 
  3.753748681741654*^9}, {3.75398593552892*^9, 
  3.753985943857585*^9}},ExpressionUUID->"44404319-de98-4c38-a602-\
c0951d2db6ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"This", " ", "is", " ", "the", " ", "main", " ", "file"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Please", " ", "Choose", " ", "a", " ", "scene", " ", "and", " ", "then", 
   " ", "run", " ", "through", " ", "this", " ", "script"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "The", " ", "scenes", " ", "are", " ", "stored", " ", "in", " ", 
   "\"\<./scenes/\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.753309178661083*^9, 3.753309235342437*^9}, {
  3.753310159012438*^9, 3.7533101871409063`*^9}, {3.7537486499407187`*^9, 
  3.753748681741654*^9}, {3.75398593552892*^9, 
  3.7539860153149233`*^9}},ExpressionUUID->"18a783d0-019d-4eea-b5f4-\
4ee073228808"],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.753308380956698*^9, 3.753308414702188*^9}, {
  3.7533084812988586`*^9, 3.753308494172968*^9}, {3.753310136220323*^9, 
  3.753310151677449*^9}, {3.753310195085279*^9, 3.753310195283207*^9}, {
  3.753317553534202*^9, 3.753317560242825*^9}, {3.75332250569803*^9, 
  3.753322513604748*^9}, {3.7533276696193457`*^9, 3.753327671664198*^9}, {
  3.753465922979494*^9, 3.753465945042613*^9}, {3.753468111960958*^9, 
  3.7534681171168127`*^9}},
 CellLabel->
  "In[236]:=",ExpressionUUID->"d53147a6-be5d-4859-9bc8-5ed97a69a79c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"-", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Open", " ", "and", " ", "run", " ", "library", " ", "scripts"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myOpenFile", "[", "filename_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "nb1", "}"}], ",", 
      RowBox[{
       RowBox[{"nb1", "=", 
        RowBox[{"NotebookOpen", "[", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</\>\"", "<>", 
          "filename"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"SelectionMove", "[", 
        RowBox[{"nb1", ",", "All", ",", "Notebook"}], "]"}], ";", "\n", 
       "     ", 
       RowBox[{"SelectionEvaluate", "[", "nb1", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"myOpenFile", "[", "\"\<./lib/funcs_math.nb\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"myOpenFile", "[", "\"\<./lib/funcs_assist.nb\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"myOpenFile", "[", "\"\<./lib/funcs_main.nb\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{" ", 
     RowBox[{"!!", 
      RowBox[{"!!", 
       RowBox[{"!!", 
        RowBox[{"!!", 
         RowBox[{"!", " ", 
          RowBox[{
          "wait", " ", "for", " ", "1", " ", "second", " ", "before", " ", 
           "running", " ", "the", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"following", " ", "!!"}], "!!"}], "!"}]}]}]}]}]}]}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.753308380956698*^9, 3.753308414702188*^9}, {
  3.7533084812988586`*^9, 3.753308494172968*^9}, {3.753310136220323*^9, 
  3.753310151677449*^9}, {3.753310195085279*^9, 3.753310195283207*^9}, {
  3.753317553534202*^9, 3.753317560242825*^9}, {3.75332250569803*^9, 
  3.753322513604748*^9}, {3.7533276696193457`*^9, 3.753327671664198*^9}, {
  3.753465922979494*^9, 3.753465945042613*^9}, {3.753468111960958*^9, 
  3.7534681171168127`*^9}, {3.7537485914891977`*^9, 3.753748595101036*^9}, {
  3.7539848309230013`*^9, 3.7539848392597857`*^9}, {3.753985379435153*^9, 
  3.753985386353973*^9}, {3.753985419714218*^9, 3.753985434394663*^9}},
 EmphasizeSyntaxErrors->True,
 CellLabel->"In[1]:=",ExpressionUUID->"c5bd22c0-e044-4e47-8284-d1c5b986a01f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"-", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Choose", " ", "a", " ", "scene"}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"myOpenFile", "[", "\"\<./scenes/scene4.nb\>\"", "]"}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.7539853899120407`*^9, 3.753985437017158*^9}, 
   3.753985970636339*^9, {3.7539860227646627`*^9, 3.7539860228787127`*^9}, {
   3.753986515776738*^9, 3.7539865158641376`*^9}, {3.7539872215037737`*^9, 
   3.753987221591097*^9}, {3.753987734972178*^9, 3.753987735054163*^9}, {
   3.75398782983597*^9, 3.753987829934422*^9}, {3.753990580306265*^9, 
   3.753990580372734*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"e17f498d-a57f-4eb4-a89e-3400996a0e75"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"-", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Set", " ", "up", " ", "all", " ", "things"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"mainResetVars", ";"}], "\[IndentingNewLine]", 
   RowBox[{"CreateObjects", ";"}], "\[IndentingNewLine]", 
   RowBox[{"RemoveDuplicateVertexs", ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<\\nStart Solving ...\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"mainSolveELeqs", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Finish Solving ...\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ddqSolve", "=", 
     RowBox[{"TurnToEq", "[", 
      RowBox[{"ddqs", ",", 
       RowBox[{"EQ", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", ";;", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<\\nStart setting impact ...\>\"", "]"}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetUpImpacts", "[", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Finish setting impact ...\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.753308565222193*^9, 3.753308611214097*^9}, {
   3.753308672890251*^9, 3.75330868069359*^9}, 3.7533089094793873`*^9, {
   3.753308953413175*^9, 3.753308954433732*^9}, {3.753308996498398*^9, 
   3.7533090000055447`*^9}, {3.753309139053328*^9, 3.753309142828926*^9}, 
   3.7533097892441072`*^9, {3.753311671624669*^9, 3.7533116717295437`*^9}, {
   3.753312240546194*^9, 3.7533122441131268`*^9}, {3.753317574018428*^9, 
   3.753317586952054*^9}, {3.753317634865655*^9, 3.753317645113809*^9}, {
   3.7533245618722258`*^9, 3.7533245621566477`*^9}, {3.753327948926567*^9, 
   3.753327955616474*^9}, {3.753329371995064*^9, 3.7533294200291767`*^9}, {
   3.753985429972849*^9, 3.753985438267434*^9}, {3.753987631878639*^9, 
   3.753987632014751*^9}},
 CellLabel->
  "In[332]:=",ExpressionUUID->"d838a9b1-f608-43fd-8306-389a6cd4fb0f"],

Cell[CellGroupData[{

Cell[BoxData["\<\"\\nStart Solving ...\"\>"], "Print",
 CellChangeTimes->{
  3.753317722711606*^9, 3.753317854784171*^9, 3.7533179740587387`*^9, 
   3.7533181457170553`*^9, 3.753318498087888*^9, {3.7533185663471403`*^9, 
   3.753318583137595*^9}, 3.753318622526113*^9, 3.753318785945004*^9, 
   3.753318981218894*^9, 3.753319185633382*^9, 3.753319887358015*^9, 
   3.753319961190015*^9, 3.753322649328223*^9, 3.7533232874425488`*^9, 
   3.753323604347797*^9, 3.753323933881208*^9, 3.753324199360199*^9, 
   3.753324419083968*^9, 3.7533246254069843`*^9, 3.753324701555211*^9, 
   3.753324963539143*^9, 3.753325055432644*^9, 3.7533261150527573`*^9, 
   3.753326649337582*^9, 3.7533272615550413`*^9, {3.7534658944548397`*^9, 
   3.753465912346718*^9}, 3.753465997092472*^9, 3.753467912237815*^9, 
   3.753468130033476*^9, 3.7534682651281548`*^9, 3.7534685890483227`*^9, 
   3.7534687508236856`*^9, 3.7534688421105347`*^9, 3.753468924882324*^9, 
   3.753469350347578*^9, 3.753469877147727*^9, 3.753646620469323*^9, 
   3.753746438519763*^9, 3.7537474367422867`*^9, 3.753747688938023*^9, 
   3.753747871406384*^9, 3.753748084578553*^9, 3.753748368621798*^9, 
   3.753748986750244*^9, 3.7537491158013563`*^9, 3.753749278428071*^9, 
   3.753749347036851*^9, 3.753749417068581*^9, 3.75374954088588*^9, 
   3.753749735549737*^9, 3.7537498232378817`*^9, 3.753749895058195*^9, {
   3.753750095149405*^9, 3.753750120228181*^9}, 3.753752147666264*^9, 
   3.7537528435340023`*^9, 3.753753022366137*^9, 3.753753053216164*^9, 
   3.7537531193635693`*^9, 3.75375323330063*^9, 3.753753450865219*^9, 
   3.753753559712166*^9, 3.753753628667182*^9, 3.753984963586464*^9, 
   3.7539860355906773`*^9, 3.7539861990799503`*^9, 3.753986518870536*^9, 
   3.7539872294165373`*^9, 3.7539878318728647`*^9, 3.753990143590955*^9, {
   3.753990584093012*^9, 3.753990591524564*^9}, 3.753990823230732*^9, 
   3.753990952560443*^9, 3.7539912873574657`*^9},
 CellLabel->
  "During evaluation of \
In[332]:=",ExpressionUUID->"092e5735-518f-44b5-8d92-56c7c2e2f079"],

Cell[BoxData["\<\"Finish Solving ...\"\>"], "Print",
 CellChangeTimes->{
  3.753317722711606*^9, 3.753317854784171*^9, 3.7533179740587387`*^9, 
   3.7533181457170553`*^9, 3.753318498087888*^9, {3.7533185663471403`*^9, 
   3.753318583137595*^9}, 3.753318622526113*^9, 3.753318785945004*^9, 
   3.753318981218894*^9, 3.753319185633382*^9, 3.753319887358015*^9, 
   3.753319961190015*^9, 3.753322649328223*^9, 3.7533232874425488`*^9, 
   3.753323604347797*^9, 3.753323933881208*^9, 3.753324199360199*^9, 
   3.753324419083968*^9, 3.7533246254069843`*^9, 3.753324701555211*^9, 
   3.753324963539143*^9, 3.753325055432644*^9, 3.7533261150527573`*^9, 
   3.753326649337582*^9, 3.7533272615550413`*^9, {3.7534658944548397`*^9, 
   3.753465912346718*^9}, 3.753465997092472*^9, 3.753467912237815*^9, 
   3.753468130033476*^9, 3.7534682651281548`*^9, 3.7534685890483227`*^9, 
   3.7534687508236856`*^9, 3.7534688421105347`*^9, 3.753468924882324*^9, 
   3.753469350347578*^9, 3.753469877147727*^9, 3.753646620469323*^9, 
   3.753746438519763*^9, 3.7537474367422867`*^9, 3.753747688938023*^9, 
   3.753747871406384*^9, 3.753748084578553*^9, 3.753748368621798*^9, 
   3.753748986750244*^9, 3.7537491158013563`*^9, 3.753749278428071*^9, 
   3.753749347036851*^9, 3.753749417068581*^9, 3.75374954088588*^9, 
   3.753749735549737*^9, 3.7537498232378817`*^9, 3.753749895058195*^9, {
   3.753750095149405*^9, 3.753750120228181*^9}, 3.753752147666264*^9, 
   3.7537528435340023`*^9, 3.753753022366137*^9, 3.753753053216164*^9, 
   3.7537531193635693`*^9, 3.75375323330063*^9, 3.753753450865219*^9, 
   3.753753559712166*^9, 3.753753628667182*^9, 3.753984963586464*^9, 
   3.7539860355906773`*^9, 3.7539861990799503`*^9, 3.753986518870536*^9, 
   3.7539872294165373`*^9, 3.7539878318728647`*^9, 3.753990143590955*^9, {
   3.753990584093012*^9, 3.753990591524564*^9}, 3.753990823230732*^9, 
   3.753990952560443*^9, 3.753991329535186*^9},
 CellLabel->
  "During evaluation of \
In[332]:=",ExpressionUUID->"bcc5d7b9-bca2-4ac9-ac78-9272514302f6"],

Cell[BoxData["\<\"\\nStart setting impact ...\"\>"], "Print",
 CellChangeTimes->{
  3.753317722711606*^9, 3.753317854784171*^9, 3.7533179740587387`*^9, 
   3.7533181457170553`*^9, 3.753318498087888*^9, {3.7533185663471403`*^9, 
   3.753318583137595*^9}, 3.753318622526113*^9, 3.753318785945004*^9, 
   3.753318981218894*^9, 3.753319185633382*^9, 3.753319887358015*^9, 
   3.753319961190015*^9, 3.753322649328223*^9, 3.7533232874425488`*^9, 
   3.753323604347797*^9, 3.753323933881208*^9, 3.753324199360199*^9, 
   3.753324419083968*^9, 3.7533246254069843`*^9, 3.753324701555211*^9, 
   3.753324963539143*^9, 3.753325055432644*^9, 3.7533261150527573`*^9, 
   3.753326649337582*^9, 3.7533272615550413`*^9, {3.7534658944548397`*^9, 
   3.753465912346718*^9}, 3.753465997092472*^9, 3.753467912237815*^9, 
   3.753468130033476*^9, 3.7534682651281548`*^9, 3.7534685890483227`*^9, 
   3.7534687508236856`*^9, 3.7534688421105347`*^9, 3.753468924882324*^9, 
   3.753469350347578*^9, 3.753469877147727*^9, 3.753646620469323*^9, 
   3.753746438519763*^9, 3.7537474367422867`*^9, 3.753747688938023*^9, 
   3.753747871406384*^9, 3.753748084578553*^9, 3.753748368621798*^9, 
   3.753748986750244*^9, 3.7537491158013563`*^9, 3.753749278428071*^9, 
   3.753749347036851*^9, 3.753749417068581*^9, 3.75374954088588*^9, 
   3.753749735549737*^9, 3.7537498232378817`*^9, 3.753749895058195*^9, {
   3.753750095149405*^9, 3.753750120228181*^9}, 3.753752147666264*^9, 
   3.7537528435340023`*^9, 3.753753022366137*^9, 3.753753053216164*^9, 
   3.7537531193635693`*^9, 3.75375323330063*^9, 3.753753450865219*^9, 
   3.753753559712166*^9, 3.753753628667182*^9, 3.753984963586464*^9, 
   3.7539860355906773`*^9, 3.7539861990799503`*^9, 3.753986518870536*^9, 
   3.7539872294165373`*^9, 3.7539878318728647`*^9, 3.753990143590955*^9, {
   3.753990584093012*^9, 3.753990591524564*^9}, 3.753990823230732*^9, 
   3.753990952560443*^9, 3.753991329537387*^9},
 CellLabel->
  "During evaluation of \
In[332]:=",ExpressionUUID->"7ac90f15-dc20-49d9-9ea4-b3bc4d673e10"],

Cell[BoxData["\<\"Finish setting impact ...\"\>"], "Print",
 CellChangeTimes->{
  3.753317722711606*^9, 3.753317854784171*^9, 3.7533179740587387`*^9, 
   3.7533181457170553`*^9, 3.753318498087888*^9, {3.7533185663471403`*^9, 
   3.753318583137595*^9}, 3.753318622526113*^9, 3.753318785945004*^9, 
   3.753318981218894*^9, 3.753319185633382*^9, 3.753319887358015*^9, 
   3.753319961190015*^9, 3.753322649328223*^9, 3.7533232874425488`*^9, 
   3.753323604347797*^9, 3.753323933881208*^9, 3.753324199360199*^9, 
   3.753324419083968*^9, 3.7533246254069843`*^9, 3.753324701555211*^9, 
   3.753324963539143*^9, 3.753325055432644*^9, 3.7533261150527573`*^9, 
   3.753326649337582*^9, 3.7533272615550413`*^9, {3.7534658944548397`*^9, 
   3.753465912346718*^9}, 3.753465997092472*^9, 3.753467912237815*^9, 
   3.753468130033476*^9, 3.7534682651281548`*^9, 3.7534685890483227`*^9, 
   3.7534687508236856`*^9, 3.7534688421105347`*^9, 3.753468924882324*^9, 
   3.753469350347578*^9, 3.753469877147727*^9, 3.753646620469323*^9, 
   3.753746438519763*^9, 3.7537474367422867`*^9, 3.753747688938023*^9, 
   3.753747871406384*^9, 3.753748084578553*^9, 3.753748368621798*^9, 
   3.753748986750244*^9, 3.7537491158013563`*^9, 3.753749278428071*^9, 
   3.753749347036851*^9, 3.753749417068581*^9, 3.75374954088588*^9, 
   3.753749735549737*^9, 3.7537498232378817`*^9, 3.753749895058195*^9, {
   3.753750095149405*^9, 3.753750120228181*^9}, 3.753752147666264*^9, 
   3.7537528435340023`*^9, 3.753753022366137*^9, 3.753753053216164*^9, 
   3.7537531193635693`*^9, 3.75375323330063*^9, 3.753753450865219*^9, 
   3.753753559712166*^9, 3.753753628667182*^9, 3.753984963586464*^9, 
   3.7539860355906773`*^9, 3.7539861990799503`*^9, 3.753986518870536*^9, 
   3.7539872294165373`*^9, 3.7539878318728647`*^9, 3.753990143590955*^9, {
   3.753990584093012*^9, 3.753990591524564*^9}, 3.753990823230732*^9, 
   3.753990952560443*^9, 3.753991334220332*^9},
 CellLabel->
  "During evaluation of \
In[332]:=",ExpressionUUID->"99658f39-9792-461a-b1e4-eacbeb5c43ac"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"-", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Set", " ", "up", " ", "params", " ", "for", " ", "NDSolve"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SetUpImpactEvents", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timeend", "=", "10"}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{"total", " ", "simulation", " ", "time"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"MAXIMPACTTIMES", "=", "10000"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"impactDetectionError", "=", "0.05"}], ";", " ", 
      RowBox[{
      "This", " ", "is", " ", "not", " ", "needed", " ", "any", " ", 
       "more"}]}], ",", " ", 
     RowBox[{
      RowBox[{"I", "'"}], "m", " ", "using", " ", "the", " ", "sign", " ", 
      "of", " ", "distance", " ", "to", " ", "detect", " ", "impacts"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"intergrationMaxStepSize", "=", "0.001"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ifprint", "=", "False"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.753308556953918*^9, 3.753308577232242*^9}, {
   3.753308684669465*^9, 3.753308685036993*^9}, {3.75330912793821*^9, 
   3.753309162723496*^9}, {3.753309840047456*^9, 3.753309855888073*^9}, {
   3.753312429834916*^9, 3.7533124320520144`*^9}, {3.753317634014289*^9, 
   3.75331764775286*^9}, {3.753317746537962*^9, 3.753317746822007*^9}, 
   3.753318007340899*^9, {3.753319048542008*^9, 3.7533190498157263`*^9}, {
   3.7533191751633453`*^9, 3.753319177177394*^9}, {3.753319794499786*^9, 
   3.753319794703724*^9}, {3.7533203142558813`*^9, 3.753320335807131*^9}, {
   3.7533203691242313`*^9, 3.753320369216901*^9}, {3.753320446820445*^9, 
   3.753320447318694*^9}, {3.753320654596387*^9, 3.753320654869029*^9}, {
   3.753320864228092*^9, 3.753320864460444*^9}, {3.753324526339973*^9, 
   3.753324594764461*^9}, 3.753326139859495*^9, {3.7533266466319313`*^9, 
   3.75332666407509*^9}, 3.753329438483163*^9, 3.753466047848481*^9, {
   3.753466449916313*^9, 3.753466454064052*^9}, {3.753466662365604*^9, 
   3.753466662450489*^9}, 3.753466748062128*^9, {3.753467085012994*^9, 
   3.7534670851079693`*^9}, {3.7534692590478477`*^9, 
   3.7534692609239073`*^9}, {3.7536466237434797`*^9, 3.753646624020008*^9}, 
   3.753748083275393*^9, 3.753748152645279*^9, {3.753749038545282*^9, 
   3.753749060557453*^9}, 3.753749767607473*^9, {3.75374991737164*^9, 
   3.75374994004021*^9}, {3.75375006579742*^9, 3.753750068127758*^9}, 
   3.753750174709489*^9, {3.7537502591334667`*^9, 3.7537502593839083`*^9}, {
   3.753750290617277*^9, 3.753750319503709*^9}, 3.753753056331522*^9, {
   3.753753323438161*^9, 3.753753325992326*^9}, {3.753984948645686*^9, 
   3.753984979692975*^9}, {3.753985080851563*^9, 3.753985103094084*^9}, {
   3.753985158544715*^9, 3.753985165418462*^9}, {3.753986059081118*^9, 
   3.753986107013493*^9}, {3.753986204713771*^9, 3.753986204851849*^9}, {
   3.753987541763967*^9, 3.753987541824312*^9}, {3.753990592826182*^9, 
   3.753990593024749*^9}, {3.753990894566813*^9, 3.753990897943959*^9}, {
   3.753991019534279*^9, 3.753991022408485*^9}},
 CellLabel->
  "In[386]:=",ExpressionUUID->"bba9cd65-ac4f-41df-b71c-9ad58c33fcef"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"-", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"NDsolve", " ", "and", " ", "Play", " ", "simulation"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"end", ",", "data", ",", "bounces"}], "}"}], "=", 
    RowBox[{"mainNDSolveSimulation", "[", 
     RowBox[{"qsInit", ",", "dqsInit"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.753308556953918*^9, 3.753308577232242*^9}, {
   3.753308684669465*^9, 3.753308685036993*^9}, {3.75330912793821*^9, 
   3.753309162723496*^9}, {3.753309840047456*^9, 3.753309855888073*^9}, {
   3.753312429834916*^9, 3.7533124320520144`*^9}, {3.753317634014289*^9, 
   3.75331764775286*^9}, {3.753317746537962*^9, 3.753317746822007*^9}, 
   3.753318007340899*^9, {3.753319048542008*^9, 3.7533190498157263`*^9}, {
   3.7533191751633453`*^9, 3.753319177177394*^9}, {3.753319794499786*^9, 
   3.753319794703724*^9}, {3.7533203142558813`*^9, 3.753320335807131*^9}, {
   3.7533203691242313`*^9, 3.753320369216901*^9}, {3.753320446820445*^9, 
   3.753320447318694*^9}, {3.753320654596387*^9, 3.753320654869029*^9}, {
   3.753320864228092*^9, 3.753320864460444*^9}, {3.753324526339973*^9, 
   3.753324594764461*^9}, 3.753326139859495*^9, {3.7533266466319313`*^9, 
   3.75332666407509*^9}, 3.753329438483163*^9, 3.753466047848481*^9, {
   3.753466449916313*^9, 3.753466454064052*^9}, {3.753466662365604*^9, 
   3.753466662450489*^9}, 3.753466748062128*^9, {3.753467085012994*^9, 
   3.7534670851079693`*^9}, {3.7534692590478477`*^9, 
   3.7534692609239073`*^9}, {3.7536466237434797`*^9, 3.753646624020008*^9}, 
   3.753748083275393*^9, 3.753748152645279*^9, {3.753749038545282*^9, 
   3.753749060557453*^9}, 3.753749767607473*^9, {3.75374991737164*^9, 
   3.75374994004021*^9}, {3.75375006579742*^9, 3.753750068127758*^9}, 
   3.753750174709489*^9, {3.7537502591334667`*^9, 3.7537502593839083`*^9}, {
   3.753750290617277*^9, 3.753750319503709*^9}, 3.753753056331522*^9, {
   3.753753323438161*^9, 3.753753325992326*^9}, {3.753984948645686*^9, 
   3.753984950442459*^9}, {3.75398610927492*^9, 3.753986109653685*^9}},
 CellLabel->
  "In[390]:=",ExpressionUUID->"6815ff44-fe72-4a3f-adab-e63cc55c1490"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Computing simulation: \"\>", "\[InvisibleSpace]", 
   "2.3842007843894417`", "\[InvisibleSpace]", "\<\" / \"\>", 
   "\[InvisibleSpace]", "10", "\[InvisibleSpace]", "\<\" ...\"\>"}],
  SequenceForm[
  "Computing simulation: ", 2.3842007843894417`, " / ", 10, " ..."],
  Editable->False]], "Print",
 CellChangeTimes->{3.75399155365527*^9},
 CellLabel->
  "During evaluation of \
In[390]:=",ExpressionUUID->"e070a30d-8ecc-48be-be78-73fd48c324bb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Computing simulation: \"\>", "\[InvisibleSpace]", 
   "5.272754654824098`", "\[InvisibleSpace]", "\<\" / \"\>", 
   "\[InvisibleSpace]", "10", "\[InvisibleSpace]", "\<\" ...\"\>"}],
  SequenceForm["Computing simulation: ", 5.272754654824098, " / ", 10, " ..."],
  Editable->False]], "Print",
 CellChangeTimes->{3.753991569611314*^9},
 CellLabel->
  "During evaluation of \
In[390]:=",ExpressionUUID->"941b47b6-b789-449b-b354-b40b4eeb279e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Computing simulation: \"\>", "\[InvisibleSpace]", 
   "7.384880002546214`", "\[InvisibleSpace]", "\<\" / \"\>", 
   "\[InvisibleSpace]", "10", "\[InvisibleSpace]", "\<\" ...\"\>"}],
  SequenceForm["Computing simulation: ", 7.384880002546214, " / ", 10, " ..."],
  Editable->False]], "Print",
 CellChangeTimes->{3.753991582023731*^9},
 CellLabel->
  "During evaluation of \
In[390]:=",ExpressionUUID->"33774aff-f11d-4dfd-b813-cb25f0466c60"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Computing simulation: \"\>", "\[InvisibleSpace]", 
   "9.518012482669949`", "\[InvisibleSpace]", "\<\" / \"\>", 
   "\[InvisibleSpace]", "10", "\[InvisibleSpace]", "\<\" ...\"\>"}],
  SequenceForm["Computing simulation: ", 9.518012482669949, " / ", 10, " ..."],
  Editable->False]], "Print",
 CellChangeTimes->{3.753991592595146*^9},
 CellLabel->
  "During evaluation of \
In[390]:=",ExpressionUUID->"161ba4a1-077c-49f2-b0bf-341dd9800f1d"],

Cell[BoxData["\<\"Not an impact\"\>"], "Print",
 CellChangeTimes->{3.753991595773666*^9},
 CellLabel->
  "During evaluation of \
In[390]:=",ExpressionUUID->"b1cf7d72-13fa-4b4f-a912-705e0f8c3492"],

Cell[BoxData["\<\"Computing simulation is completed.\"\>"], "Print",
 CellChangeTimes->{3.7539915957836647`*^9},
 CellLabel->
  "During evaluation of \
In[390]:=",ExpressionUUID->"bf0182b5-054e-41ed-b23b-3ce50ee33150"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Plot", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plotVariablesValues", ";"}], "\[IndentingNewLine]", 
   RowBox[{"plotHamValues", ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "Remove", " ", "the", " ", "semicolon", " ", "to", " ", "plot", " ", 
     "Hamiltonian", " ", "and", " ", 
     RowBox[{"Vars", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ImageSizeXrange", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"ImageSizeYrange", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "3"}], ",", "3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{"plotAnimation", "[", 
    RowBox[{"{", 
     RowBox[{"ImageSizeXrange", ",", "ImageSizeYrange"}], "}"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.753308556953918*^9, 3.753308577232242*^9}, {
   3.753308684669465*^9, 3.753308685036993*^9}, {3.75330912793821*^9, 
   3.753309162723496*^9}, {3.753309840047456*^9, 3.753309855888073*^9}, {
   3.753312429834916*^9, 3.7533124320520144`*^9}, {3.753317634014289*^9, 
   3.75331764775286*^9}, {3.753317746537962*^9, 3.753317746822007*^9}, 
   3.753318007340899*^9, {3.753319048542008*^9, 3.7533190498157263`*^9}, {
   3.7533191751633453`*^9, 3.753319177177394*^9}, {3.753319794499786*^9, 
   3.753319794703724*^9}, {3.7533203142558813`*^9, 3.753320335807131*^9}, {
   3.7533203691242313`*^9, 3.753320369216901*^9}, {3.753320446820445*^9, 
   3.753320447318694*^9}, {3.753320654596387*^9, 3.753320654869029*^9}, {
   3.753320864228092*^9, 3.753320864460444*^9}, {3.753324526339973*^9, 
   3.753324594764461*^9}, 3.753326139859495*^9, {3.7533266466319313`*^9, 
   3.75332666407509*^9}, 3.753329438483163*^9, 3.753466047848481*^9, {
   3.753466449916313*^9, 3.753466454064052*^9}, {3.753466662365604*^9, 
   3.753466662450489*^9}, 3.753466748062128*^9, {3.753467085012994*^9, 
   3.7534670851079693`*^9}, {3.7534692590478477`*^9, 
   3.7534692609239073`*^9}, {3.7536466237434797`*^9, 3.753646624020008*^9}, 
   3.753748083275393*^9, 3.753748152645279*^9, {3.753749038545282*^9, 
   3.753749060557453*^9}, {3.753749138230472*^9, 3.753749140874048*^9}, {
   3.7537492083583937`*^9, 3.753749216801887*^9}, {3.753750124342456*^9, 
   3.7537501604591217`*^9}, {3.7537509394485207`*^9, 3.753750980557629*^9}, {
   3.753751232006172*^9, 3.753751234736335*^9}, {3.753985062006345*^9, 
   3.753985073569663*^9}, {3.753985177974321*^9, 3.753985211330346*^9}, {
   3.7539861242996597`*^9, 3.753986127126912*^9}, {3.753986347626979*^9, 
   3.753986351123509*^9}, {3.753986985445444*^9, 3.753987014564838*^9}, {
   3.7539874454007177`*^9, 3.753987509477294*^9}},
 CellLabel->
  "In[391]:=",ExpressionUUID->"81adfd1e-edc8-40d0-a533-430ae1c36c3f"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`t$$ = 1.5608253479003906`, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`t$$], 0, 10}}, Typeset`size$$ = {720., {271., 282.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`t$158533$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`t$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`t$$, $CellContext`t$158533$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[{
         Graphics[{
           Thickness[0.005], 
           $CellContext`LinksForAnimation[$CellContext`t$$]}], 
         Graphics[{
           PointSize[0.02], 
           $CellContext`pointsForAnimation[$CellContext`t$$]}]}, 
        PlotRange -> {{-4, 4}, {-3, 3}}, Frame -> True], 
      "Specifications" :> {{$CellContext`t$$, 0, 10, AnimationRate -> 1, 
         AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{806., {338., 350.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.753987015155628*^9, 3.753987025037814*^9}, 
   3.7539873096315413`*^9, 3.753987446790884*^9, {3.75398750569422*^9, 
   3.75398751002952*^9}, 3.753987625136093*^9, 3.753987703564786*^9, 
   3.753990242881358*^9, 3.753990328765621*^9, {3.753990370652053*^9, 
   3.7539903830394497`*^9}, 3.753990413618636*^9, 3.7539906694551973`*^9, 
   3.753990902570622*^9, 3.75399100206444*^9, 3.7539910756237164`*^9, 
   3.753991597392193*^9},
 CellLabel->
  "Out[395]=",ExpressionUUID->"63a10fdd-fb8c-40d0-b85b-c583fe29a5f0"]
}, Open  ]]
},
WindowSize->{1920, 960},
WindowMargins->{{0, Automatic}, {0, Automatic}},
Magnification->2.,
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 550, 14, 106, "Input",ExpressionUUID->"44404319-de98-4c38-a602-c0951d2db6ec"],
Cell[1111, 36, 728, 17, 147, "Input",ExpressionUUID->"18a783d0-019d-4eea-b5f4-4ee073228808"],
Cell[1842, 55, 592, 10, 60, "Input",ExpressionUUID->"d53147a6-be5d-4859-9bc8-5ed97a69a79c"],
Cell[2437, 67, 3292, 86, 448, "Input",ExpressionUUID->"c5bd22c0-e044-4e47-8284-d1c5b986a01f"],
Cell[5732, 155, 1761, 49, 176, "Input",ExpressionUUID->"e17f498d-a57f-4eb4-a89e-3400996a0e75"],
Cell[CellGroupData[{
Cell[7518, 208, 3086, 76, 735, "Input",ExpressionUUID->"d838a9b1-f608-43fd-8306-389a6cd4fb0f"],
Cell[CellGroupData[{
Cell[10629, 288, 2027, 30, 89, "Print",ExpressionUUID->"092e5735-518f-44b5-8d92-56c7c2e2f079"],
Cell[12659, 320, 2023, 30, 48, "Print",ExpressionUUID->"bcc5d7b9-bca2-4ac9-ac78-9272514302f6"],
Cell[14685, 352, 2032, 30, 89, "Print",ExpressionUUID->"7ac90f15-dc20-49d9-9ea4-b3bc4d673e10"],
Cell[16720, 384, 2030, 30, 48, "Print",ExpressionUUID->"99658f39-9792-461a-b1e4-eacbeb5c43ac"]
}, Open  ]]
}, Open  ]],
Cell[18777, 418, 4181, 89, 434, "Input",ExpressionUUID->"bba9cd65-ac4f-41df-b71c-9ad58c33fcef"],
Cell[CellGroupData[{
Cell[22983, 511, 3141, 67, 176, "Input",ExpressionUUID->"6815ff44-fe72-4a3f-adab-e63cc55c1490"],
Cell[CellGroupData[{
Cell[26149, 582, 493, 11, 48, "Print",ExpressionUUID->"e070a30d-8ecc-48be-be78-73fd48c324bb"],
Cell[26645, 595, 488, 10, 48, "Print",ExpressionUUID->"941b47b6-b789-449b-b354-b40b4eeb279e"],
Cell[27136, 607, 488, 10, 48, "Print",ExpressionUUID->"33774aff-f11d-4dfd-b813-cb25f0466c60"],
Cell[27627, 619, 488, 10, 48, "Print",ExpressionUUID->"161ba4a1-077c-49f2-b0bf-341dd9800f1d"],
Cell[28118, 631, 195, 4, 48, "Print",ExpressionUUID->"b1cf7d72-13fa-4b4f-a912-705e0f8c3492"],
Cell[28316, 637, 218, 4, 48, "Print",ExpressionUUID->"bf0182b5-054e-41ed-b23b-3ce50ee33150"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28583, 647, 2829, 54, 305, "Input",ExpressionUUID->"81adfd1e-edc8-40d0-a533-430ae1c36c3f"],
Cell[31415, 703, 2682, 53, 753, "Output",ExpressionUUID->"63a10fdd-fb8c-40d0-b85b-c583fe29a5f0"]
}, Open  ]]
}
]
*)

