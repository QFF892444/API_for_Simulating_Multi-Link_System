(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    108710,       2488]
NotebookOptionsPosition[    106310,       2446]
NotebookOutlinePosition[    106664,       2462]
CellTagsIndexPosition[    106621,       2459]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 StyleBox[
  RowBox[{"(*", "Final", "*)"}],
  FontSize->28,
  FontWeight->"Bold",
  FontColor->RGBColor[0, 0, 1]]], "Input",
 CellChangeTimes->{{3.752856441079928*^9, 3.752856478002857*^9}, {
   3.752856614876956*^9, 3.752856740407585*^9}, {3.752857349635654*^9, 
   3.7528573641489067`*^9}, {3.752858198794065*^9, 3.7528581999292603`*^9}, 
   3.7528918403995743`*^9, {3.7528961817048273`*^9, 3.7528962191940603`*^9}, {
   3.752937212844871*^9, 3.752937224444496*^9}, {3.75294339441866*^9, 
   3.7529434180825357`*^9}, {3.752943559013653*^9, 3.752943561469325*^9}, {
   3.752943661738035*^9, 3.752943707796466*^9}, {3.7529439315733147`*^9, 
   3.752943937463044*^9}, {3.752945087432394*^9, 3.752945160930595*^9}, {
   3.752945280056671*^9, 3.752945287073347*^9}, {3.75294553242769*^9, 
   3.752945629895801*^9}, {3.752945979948072*^9, 3.752946001821425*^9}, {
   3.753053373675827*^9, 3.7530534089667683`*^9}, {3.753057277402*^9, 
   3.753057299216235*^9}, {3.753058012958432*^9, 3.753058044931511*^9}, {
   3.7530580860523443`*^9, 3.753058094410119*^9}, {3.753058323290696*^9, 
   3.753058324836581*^9}, {3.753119695290847*^9, 3.753119700840918*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"266e0836-dc31-4677-a6fd-4e7ecb2b8656"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", " ", "Math"}]}]}]}]}]}]}], " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"functions", " ", "--"}], "--"}], "--"}], "--"}], 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", "-"}]}]}]}], "*)"}], 
  StyleBox["\[IndentingNewLine]",
   FontSize->28,
   FontWeight->"Bold",
   FontColor->RGBColor[0, 0, 1]], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Rotz4", "[", "\[Theta]_", "]"}], ":=", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"Cos", "[", "\[Theta]", "]"}], 
         RowBox[{"-", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "0", "0"},
        {
         RowBox[{"Sin", "[", "\[Theta]", "]"}], 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "0", "0"},
        {"0", "0", "1", "0"},
        {"0", "0", "0", "1"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rotz", "[", "\[Theta]_", "]"}], ":=", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"Cos", "[", "\[Theta]", "]"}], 
         RowBox[{"-", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "0"},
        {
         RowBox[{"Sin", "[", "\[Theta]", "]"}], 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "0"},
        {"0", "0", "1"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vec3", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "v3_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "v1", "}"}], ",", 
      RowBox[{"{", "v2", "}"}], ",", 
      RowBox[{"{", "v3", "}"}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Trans4", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "x"},
       {"0", "1", "0", "y"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NewT4", "[", 
     RowBox[{"x_", ",", "y_", ",", "\[Theta]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Trans4", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ".", 
     RowBox[{"Rotz4", "[", "\[Theta]", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Zeros", "[", 
     RowBox[{"dim1_", ",", "dim2_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "dim1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "dim2"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MF", "[", "T_", "]"}], ":=", 
    RowBox[{"MatrixForm", "[", "T", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Skew", " ", "funcs"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hat", "[", "\[Omega]_", "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {"0", 
        RowBox[{"-", 
         RowBox[{"\[Omega]", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}], 
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]},
       {
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}], "0", 
        RowBox[{"-", 
         RowBox[{"\[Omega]", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}]},
       {
        RowBox[{"-", 
         RowBox[{"\[Omega]", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], 
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "0"}
      }], ")"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Unhat", "[", "\[Omega]_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "2"}], "]"}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Omega]", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "3"}], "]"}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Omega]", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"generalized", " ", 
      RowBox[{"hat", ":", " ", "g"}]}], " ", "->", " ", "twist"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Genhat2", "[", 
     RowBox[{"\[Omega]_", ",", "v_"}], "]"}], ":=", 
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"Hat", "[", "\[Omega]", "]"}], "v"},
        {
         RowBox[{"Zeros", "[", 
          RowBox[{"1", ",", "3"}], "]"}], "0"}
       }], ")"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Genhat", "[", "S_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]", ",", "v"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Omega]", "=", 
        RowBox[{"S", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "3"}], ",", 
           RowBox[{"1", ";;", "1"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"v", "=", 
        RowBox[{"S", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"4", ";;", "6"}], ",", 
           RowBox[{"1", ";;", "1"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Genhat2", "[", 
        RowBox[{"\[Omega]", ",", "v"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GenUnhat", "[", "T_", "]"}], ":=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Unhat", "[", 
       RowBox[{"T", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "3"}], ",", 
          RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "]"}], ",", 
      RowBox[{"T", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "3"}], ",", 
         RowBox[{"4", ";;", "4"}]}], "]"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AdT", "[", "T_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R", ",", "p"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"R", "=", 
        RowBox[{"T", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "3"}], ",", 
           RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"T", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "3"}], ",", 
           RowBox[{"4", ";;", "4"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"(", GridBox[{
           {"R", 
            RowBox[{"Zeros", "[", 
             RowBox[{"3", ",", "3"}], "]"}]},
           {
            RowBox[{
             RowBox[{"Hat", "[", "p", "]"}], ".", "R"}], "R"}
          }], ")"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InvT", "[", "T_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R", ",", "p"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"R", "=", 
        RowBox[{"T", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "3"}], ",", 
           RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"T", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "3"}], ",", 
           RowBox[{"4", ";;", "4"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Transpose", "[", "R", "]"}], 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"Transpose", "[", "R", "]"}], ".", "p"}]}]},
           {
            RowBox[{"Zeros", "[", 
             RowBox[{"1", ",", "3"}], "]"}], "1"}
          }], ")"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Math", " ", "funcs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "return", " ", "the", " ", "distance", " ", "between", " ", "p1", " ", 
     "and", " ", "p2"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CalcDist", "[", 
      RowBox[{"x1_", ",", "y1_", ",", "x2_", ",", "y2_"}], "]"}], ":=", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x2", "-", "x1"}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y2", "-", "y1"}], ")"}], "^", "2"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"return", " ", "the", " ", "angle", " ", "between", " ", 
     RowBox[{"(", 
      RowBox[{"pb", ",", "p0"}], ")"}], " ", "and", " ", 
     RowBox[{"(", 
      RowBox[{"pb", ",", "p1"}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"CosLaw", "[", 
      RowBox[{
      "x0_", ",", "y0_", ",", "x1_", ",", "y1_", ",", "xb_", ",", "yb_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c", ",", "costheta"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{"CalcDist", "[", 
          RowBox[{"xb", ",", "yb", ",", "x0", ",", "y0"}], "]"}]}], ";", "\n",
         "       ", 
        RowBox[{"b", "=", 
         RowBox[{"CalcDist", "[", 
          RowBox[{"xb", ",", "yb", ",", "x1", ",", "y1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"CalcDist", "[", 
          RowBox[{"x0", ",", "y0", ",", "x1", ",", "y1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"costheta", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", "^", "2"}], "+", 
            RowBox[{"b", "^", "2"}], "-", 
            RowBox[{"c", "^", "2"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", "*", "a", "*", "b"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ArcCos", "[", "costheta", "]"}]}]}], "\n", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"myArcTan", "[", 
      RowBox[{"x0_", ",", "y0_", ",", "x1_", ",", "y1_"}], "]"}], ":=", 
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"y1", "-", "y0"}], ",", 
       RowBox[{"x1", "-", "x0"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"myPiToPi", "[", "theta_", "]"}], ":=", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"theta", ">", "Pi"}], ",", 
       RowBox[{"theta", "-", 
        RowBox[{"2", "*", "Pi"}]}], ",", 
       RowBox[{"theta", "<", 
        RowBox[{"-", "Pi"}]}], ",", 
       RowBox[{"theta", "+", 
        RowBox[{"2", "*", "Pi"}]}], ",", "True", ",", "theta"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Check", " ", "if", " ", "the", " ", "projection", " ", "of", " ", 
      "pb"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"xb", ",", "yb"}], ")"}], " ", "is", " ", "in", " ", "the", 
      " ", "line", " ", "of", " ", 
      RowBox[{"p0", "~", "p1"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"isInLine", "[", 
      RowBox[{
      "x0_", ",", "y0_", ",", "x1_", ",", "y1_", ",", "xb_", ",", "yb_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dx", ",", "dy", ",", "innerproduct"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dx", "=", 
         RowBox[{"x1", "-", "x0"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dy", "=", 
         RowBox[{"y1", "-", "y0"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"innerproduct", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"xb", "-", "x0"}], ")"}], "*", "dx"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"yb", "-", "y0"}], ")"}], "*", "dy"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"0", "\[LessEqual]", "innerproduct"}], "&&", 
         RowBox[{"innerproduct", "\[LessEqual]", 
          RowBox[{
           RowBox[{"dx", "*", "dx"}], "+", 
           RowBox[{"dy", "*", "dy"}]}]}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Mathematica", " ", "expression", " ", "related", " ", "funcs"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"setTimeVars", "[", "vs_", "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vs", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "vs", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TurnToEq", "[", 
      RowBox[{"list1_", ",", "list2_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Flatten", "[", "list1", "]"}]}], ";", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"tmp", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "==", 
           RowBox[{"list2", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "tmp", "]"}]}], "}"}]}], "]"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"-", " ", "Math"}]}]}]}]}]}], " ", "funcs", " ", "ends", 
      " ", 
      RowBox[{"here", ".", " ", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", "-"}]}]}]}]}]}]}]}]}], ";", 
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", " ", "Below"}]}]}]}]}]}]}], " ", "are", " ", "the", 
      " ", "main", " ", 
      RowBox[{"program", ".", " ", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", "--"}]}]}]}]}]}]}]}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.752856441079928*^9, 3.752856478002857*^9}, {
   3.752856614876956*^9, 3.752856740407585*^9}, {3.752857349635654*^9, 
   3.7528573641489067`*^9}, {3.752858198794065*^9, 3.7528581999292603`*^9}, 
   3.7528918403995743`*^9, {3.7528961817048273`*^9, 3.7528962191940603`*^9}, {
   3.752937212844871*^9, 3.752937224444496*^9}, {3.75294339441866*^9, 
   3.7529434180825357`*^9}, {3.752943559013653*^9, 3.752943561469325*^9}, {
   3.752943661738035*^9, 3.752943707796466*^9}, {3.7529439315733147`*^9, 
   3.752943937463044*^9}, {3.752945087432394*^9, 3.752945160930595*^9}, {
   3.752945280056671*^9, 3.752945287073347*^9}, {3.75294553242769*^9, 
   3.752945629895801*^9}, {3.752945979948072*^9, 3.752946001821425*^9}, {
   3.753053373675827*^9, 3.7530534089667683`*^9}, {3.753057277402*^9, 
   3.753057299216235*^9}, {3.753058012958432*^9, 3.753058044931511*^9}, {
   3.75312405254565*^9, 3.7531241386753283`*^9}, {3.7531261973203*^9, 
   3.753126197444743*^9}, {3.75312635997136*^9, 3.753126370265277*^9}, {
   3.753126504777323*^9, 3.753126505841411*^9}, {3.75312674562322*^9, 
   3.753126766725313*^9}, {3.7531401785465193`*^9, 3.753140182400977*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"8f92c5b0-8289-4350-8eb8-516898d33f22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"vars", " ", "--"}], "--"}], "--"}], "--"}], "--"}],
               "--"}], "--"}], "--"}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nVars", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GetKE", "[", 
      RowBox[{"Gb_", ",", "Vb_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"1", "/", "2"}], "*", 
        RowBox[{
         RowBox[{"Transpose", "[", "Vb", "]"}], ".", "Gb", ".", "Vb"}]}], 
       ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"GetPE", "[", 
      RowBox[{"m_", ",", "T_"}], "]"}], ":=", 
     RowBox[{"m", "*", "g", "*", 
      RowBox[{"T", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "4"}], "]"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qs", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qsvars", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qsInit", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dqsInit", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", " ", 
           RowBox[{
            RowBox[{"objects", " ", "--"}], "--"}]}]}]}]}]}]}], 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", "-"}]}]}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nObjects", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"objNames", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "Properties", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"l", "=", 
     RowBox[{"l1", "=", 
      RowBox[{"l2", "=", 
       RowBox[{"l3", "=", "1"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w", "=", 
     RowBox[{"w1", "=", 
      RowBox[{"w2", "=", 
       RowBox[{"w3", "=", "0.25"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"masses", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"inertias", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lens", "=", 
     RowBox[{"{", 
      RowBox[{"l1", ",", "l2", ",", "l3"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"widths", "=", 
     RowBox[{"{", 
      RowBox[{"w1", ",", "w2", ",", "w3"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g", "=", "9.8"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Transformation", " ", "matrices"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ts", "=", 
     RowBox[{"{", "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.753123308026244*^9, 3.75312331483188*^9}, 
   3.753123349784988*^9, {3.75312342183265*^9, 3.753123446292471*^9}, {
   3.75312364850945*^9, 3.753123689236961*^9}, {3.753123767898006*^9, 
   3.7531238344427834`*^9}, {3.753124143544293*^9, 3.753124543600301*^9}, {
   3.753124575884509*^9, 3.753124583783622*^9}, {3.753124722765585*^9, 
   3.753124724272087*^9}, {3.753125150356867*^9, 3.753125150953199*^9}, {
   3.75312524655254*^9, 3.7531253037661867`*^9}, 3.753126774188662*^9, {
   3.7531269901910887`*^9, 3.753126993347027*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"1bdb90c2-7289-45c2-a579-eed7e16aa45d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", " ", "Create"}]}]}]}]}]}], " ", 
    RowBox[{
     RowBox[{"objects", " ", "--"}], "--"}], 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", "-"}]}]}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CreateTriangle", "[", 
      RowBox[{"l_", ",", "objqsinit_", ",", "objdqsinit_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", "Properties", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"objNames", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"objNames", ",", "\"\<Triangle\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mass", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"inertia", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "Vars", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"nDOF", "=", "3"}], ";", "\[IndentingNewLine]", 
        RowBox[{"objqsvars", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Symbol", "[", 
            RowBox[{"\"\<$q\>\"", "<>", 
             RowBox[{"ToString", "@", "i"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"nVars", "+", "1"}], ",", 
             RowBox[{"nVars", "+", "nDOF"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"objqs", "=", 
         RowBox[{"setTimeVars", "[", "objqsvars", "]"}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{"x", " ", "\[Rule]", " ", 
          RowBox[{"x", "[", "t", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        
        RowBox[{"x", "=", 
         RowBox[{"objqsvars", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"y", "=", 
         RowBox[{"objqsvars", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Theta]", "=", 
         RowBox[{"objqsvars", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "Geometry", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Tw", "=", 
         RowBox[{"Trans4", "[", 
          RowBox[{"0", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"T1", "=", 
         RowBox[{
          RowBox[{"Tw", ".", 
           RowBox[{"Trans4", "[", 
            RowBox[{
             RowBox[{"x", "[", "t", "]"}], ",", 
             RowBox[{"y", "[", "t", "]"}]}], "]"}], ".", 
           RowBox[{"Rotz4", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "//", 
          "Simplify"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"p1End1", "=", 
         RowBox[{
          RowBox[{"T1", ".", 
           SuperscriptBox[
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"l", "/", 
                RowBox[{"Sqrt", "[", "3", "]"}]}], ",", "0", ",", "1"}], 
              "}"}], "}"}], "\[Transpose]"]}], "//", "Simplify"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p1End2", "=", 
         RowBox[{
          RowBox[{"T1", ".", 
           SuperscriptBox[
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"l", "/", "2"}], ",", 
               RowBox[{
                RowBox[{"-", "l"}], "/", 
                RowBox[{"(", 
                 RowBox[{"2", "*", 
                  RowBox[{"Sqrt", "[", "3", "]"}]}], ")"}]}], ",", "0", ",", 
               "1"}], "}"}], "}"}], "\[Transpose]"]}], "//", "Simplify"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"p1End3", "=", 
         RowBox[{
          RowBox[{"T1", ".", 
           SuperscriptBox[
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "l"}], "/", "2"}], ",", 
               RowBox[{
                RowBox[{"-", "l"}], "/", 
                RowBox[{"(", 
                 RowBox[{"2", "*", 
                  RowBox[{"Sqrt", "[", "3", "]"}]}], ")"}]}], ",", "0", ",", 
               "1"}], "}"}], "}"}], "\[Transpose]"]}], "//", "Simplify"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"p1Ends", "=", 
         RowBox[{"{", 
          RowBox[{"p1End1", ",", "p1End2", ",", "p1End3"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "/", "Update"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"nObjects", "=", 
         RowBox[{"nObjects", "+", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nVars", "=", 
         RowBox[{"nVars", "+", "nDOF"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"qs", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"qs", ",", "objqs"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"qsvars", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"qsvars", ",", "objqsvars"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Ts", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"Ts", ",", "T1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"masses", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"masses", ",", "mass"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"inertias", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"inertias", ",", "inertia"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"qsInit", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"qsInit", ",", "objqsinit"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dqsInit", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"dqsInit", ",", "objdqsinit"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "Return", "*)"}], "\[IndentingNewLine]", "T1"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "Triangle", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t1len", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t1qsInit", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t1dqsInit", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gTriangle1", "=", 
     RowBox[{"CreateTriangle", "[", 
      RowBox[{"t1len", ",", "t1qsInit", ",", "t1dqsInit"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.753123308026244*^9, 3.75312331483188*^9}, 
   3.753123349784988*^9, {3.75312342183265*^9, 3.753123446292471*^9}, {
   3.75312364850945*^9, 3.753123689236961*^9}, {3.753123767898006*^9, 
   3.7531238344427834`*^9}, {3.753124143544293*^9, 3.753124543600301*^9}, {
   3.753124575884509*^9, 3.753124622807371*^9}, {3.7531247795429697`*^9, 
   3.753124798551197*^9}, {3.753124836658353*^9, 3.753124847222664*^9}, {
   3.753124887582152*^9, 3.753124987457034*^9}, {3.7531250958458347`*^9, 
   3.753125134746017*^9}, {3.7531252964159603`*^9, 3.753125328591198*^9}, {
   3.75312536424496*^9, 3.7531253845780573`*^9}, 3.753125622199383*^9, {
   3.753126029300434*^9, 3.753126047307187*^9}, {3.7531263323099194`*^9, 
   3.753126347515335*^9}, {3.7531265103023243`*^9, 3.753126525702654*^9}, {
   3.7531267777313747`*^9, 3.7531267795559464`*^9}, {3.7531269705473967`*^9, 
   3.753127127751376*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"e92d9418-9387-4936-8a0c-7e816792a362"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Prepare", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dqs", "=", 
     RowBox[{"D", "[", 
      RowBox[{"qs", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ddqs", "=", 
     RowBox[{"D", "[", 
      RowBox[{"dqs", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qsInit", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "nVars"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dqsInit", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "nVars"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.753044835778154*^9, 3.753044853243857*^9}, {
   3.753044885735341*^9, 3.753045087762558*^9}, {3.753045119526952*^9, 
   3.7530451980018806`*^9}, {3.753045233241619*^9, 3.753045330223648*^9}, {
   3.753045375327367*^9, 3.753045428238071*^9}, {3.753045470005053*^9, 
   3.753045488477352*^9}, {3.753045548631014*^9, 3.7530455872391768`*^9}, {
   3.7530461846478233`*^9, 3.753046189098051*^9}, {3.753049997171638*^9, 
   3.7530500196938667`*^9}, {3.753050066769712*^9, 3.7530500913759336`*^9}, {
   3.75305016165658*^9, 3.75305017743246*^9}, {3.75305020772898*^9, 
   3.753050237021182*^9}, {3.753050294237818*^9, 3.753050430715755*^9}, {
   3.753050508246562*^9, 3.753050561137941*^9}, {3.753050973890109*^9, 
   3.7530509843757143`*^9}, {3.753051073460733*^9, 3.753051081270372*^9}, {
   3.7530513907609*^9, 3.753051417218584*^9}, {3.75305148489613*^9, 
   3.7530515464564962`*^9}, {3.7530525178993607`*^9, 3.753052521284204*^9}, {
   3.753052551473435*^9, 3.753052557247499*^9}, 3.753052592897394*^9, {
   3.7530526901642733`*^9, 3.753052695814392*^9}, {3.753052738897628*^9, 
   3.753052845859419*^9}, {3.753053011553212*^9, 3.753053015960785*^9}, {
   3.7530530507527637`*^9, 3.753053061062314*^9}, {3.753053437625102*^9, 
   3.753053445291786*^9}, {3.753053652581946*^9, 3.75305365795931*^9}, {
   3.753054130043837*^9, 3.753054146860914*^9}, 3.753054369689734*^9, {
   3.7530552140086317`*^9, 3.753055214948401*^9}, {3.753055568100189*^9, 
   3.753055571428176*^9}, {3.7531199350230217`*^9, 3.753119968194673*^9}, {
   3.753120012736985*^9, 3.753120113773282*^9}, {3.753120155403681*^9, 
   3.753120177087166*^9}, 3.753120297603888*^9, {3.753120335222054*^9, 
   3.7531203707053003`*^9}, 3.7531236592510357`*^9, 3.753124567923814*^9, {
   3.753124696657449*^9, 3.753124700234228*^9}, {3.7531251550577517`*^9, 
   3.753125161024935*^9}, {3.753126782565262*^9, 3.753126804502275*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"86e25054-c6c5-43bc-b27c-ddc5bfdc0a87"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"-", " ", "Left"}]}]}]}]}]}]}]}], " ", "side", " ", "of", 
     " ", "EL", " ", 
     RowBox[{
      RowBox[{"eqs", " ", "--"}], "--"}]}], "-", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "-"}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Body", " ", "generalized", " ", "mass"}], ",", " ", 
    RowBox[{
    "composed", " ", "of", " ", "Inertia", " ", "Tensor", " ", "and", " ", 
     "Mass", " ", "Matrix"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"getGb", "[", 
     RowBox[{"j_", ",", "m_"}], "]"}], ":=", 
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"{", 
           RowBox[{"j", ",", "j", ",", "j"}], "}"}], "]"}], 
         RowBox[{"Zeros", "[", 
          RowBox[{"3", ",", "3"}], "]"}]},
        {
         RowBox[{"Zeros", "[", 
          RowBox[{"3", ",", "3"}], "]"}], 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"{", 
           RowBox[{"m", ",", "m", ",", "m"}], "}"}], "]"}]}
       }], ")"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Gbs", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"getGb", "[", 
         RowBox[{
          RowBox[{"inertias", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"masses", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nObjects"}], "}"}]}], "]"}], "//", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Body", " ", "screw", " ", "axis"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vbs", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"GenUnhat", "[", 
         RowBox[{
          RowBox[{"InvT", "[", 
           RowBox[{"Ts", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"Ts", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}]}], "]"}], ",", 
        
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nObjects"}], "}"}]}], "]"}], "//", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Lagrange", " ", 
     RowBox[{"Equations", ":", " ", 
      RowBox[{"Kinetic", " ", "and", " ", "Potential", " ", "Energy"}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GetKE", "[", 
      RowBox[{"Gb_", ",", "Vb_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"1", "/", "2"}], "*", 
        RowBox[{
         RowBox[{"Transpose", "[", "Vb", "]"}], ".", "Gb", ".", "Vb"}]}], 
       ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"GetPE", "[", 
      RowBox[{"m_", ",", "T_"}], "]"}], ":=", 
     RowBox[{"m", "*", "g", "*", 
      RowBox[{"T", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "4"}], "]"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KEs", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"GetKE", "[", 
         RowBox[{
          RowBox[{"Gbs", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"Vbs", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nObjects"}], "}"}]}], "]"}], "//", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PEs", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"GetPE", "[", 
         RowBox[{
          RowBox[{"masses", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"Ts", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nObjects"}], "}"}]}], "]"}], "//", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Lag", "=", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"Join", "[", 
        RowBox[{"KEs", ",", 
         RowBox[{"-", "PEs"}]}], "]"}], "]"}], "//", "Simplify"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Left", " ", "side", " ", "of", " ", "Euler"}], "-", 
     RowBox[{"Lagrange", " ", "Equations"}]}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"ELeqsLeft", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"Lag", ",", 
           RowBox[{"{", "dqs", "}"}]}], "]"}], ",", "t"}], "]"}], "-", 
       RowBox[{"D", "[", 
        RowBox[{"Lag", ",", 
         RowBox[{"{", "qs", "}"}]}], "]"}]}], "//", "Simplify"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.753057076566051*^9, 3.753057082906145*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"475c42ee-2785-4311-afba-ef5380bb1e53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"-", " ", "Right"}]}]}]}]}]}]}]}], " ", "side", " ", "of",
      " ", "EL", " ", 
     RowBox[{
      RowBox[{"eqs", " ", "--"}], "--"}]}], "-", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "-"}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Constraints", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"conslink1P1x", "=", 
     RowBox[{
      RowBox[{"p1Ends", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{"y", "=", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"conslink1P1y", "=", 
     RowBox[{
      RowBox[{"p1Ends", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"y", "=", "0"}], " ", "*)"}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cons", "=", 
     RowBox[{
      RowBox[{"{", "}"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"nCons", "=", 
     RowBox[{"Length", "[", "cons", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"nCons", ">", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Lambda]s", "=", 
         SuperscriptBox[
          RowBox[{"{", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Symbol", "[", 
              RowBox[{"\"\<$\[Lambda]\>\"", "<>", 
               RowBox[{"ToString", "@", "i"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "nCons"}], "}"}]}], "]"}], "}"}], 
          "\[Transpose]"]}], ";", "\[IndentingNewLine]", 
        RowBox[{"consgrad", "=", 
         SuperscriptBox[
          RowBox[{"Grad", "[", 
           RowBox[{"cons", ",", "qs"}], "]"}], "\[Transpose]"]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Grad", "[", 
            RowBox[{"2", ",", "5"}], "]"}], "\[Rule]", 
           RowBox[{"Mat", 
            RowBox[{"(", 
             RowBox[{"2", ",", "5"}], ")"}]}]}], ",", 
          RowBox[{"Transpose", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"5", ",", "2"}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"consddt", "=", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"cons", ",", "t"}], "]"}], ",", "t"}], "]"}], "//", 
          "Simplify"}]}]}], ")"}]}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7492477302784853`*^9, 3.749247744886393*^9}, {
   3.7492477952349367`*^9, 3.749248083936611*^9}, {3.749248115745202*^9, 
   3.749248163943199*^9}, {3.749248289782309*^9, 3.749248327237639*^9}, {
   3.7492488740168123`*^9, 3.74924890110975*^9}, {3.749249013872342*^9, 
   3.749249016428877*^9}, {3.749249715340942*^9, 3.749249725558988*^9}, {
   3.7492533635649853`*^9, 3.7492533692042627`*^9}, {3.7493304687035713`*^9, 
   3.749330526784474*^9}, {3.749583890558482*^9, 3.749584019739238*^9}, {
   3.749584051620141*^9, 3.749584289697188*^9}, {3.7495848842278976`*^9, 
   3.749584884428755*^9}, {3.7495854188247633`*^9, 3.749585430018347*^9}, {
   3.749586473817123*^9, 3.7495865299870358`*^9}, {3.74958656315245*^9, 
   3.749586572384222*^9}, {3.749586714939041*^9, 3.7495867151800013`*^9}, 
   3.749586749984033*^9, 3.749586785597528*^9, {3.7495868834456167`*^9, 
   3.749586991001513*^9}, {3.749587032904327*^9, 3.749587066122258*^9}, {
   3.749587120426735*^9, 3.749587127859918*^9}, {3.7495872147347593`*^9, 
   3.749587215589427*^9}, {3.749587264417486*^9, 3.74958727343836*^9}, {
   3.749587370691258*^9, 3.749587371064513*^9}, {3.7495874282297573`*^9, 
   3.74958742881262*^9}, {3.7495874807284613`*^9, 3.749587485622819*^9}, {
   3.749587551022369*^9, 3.749587551318131*^9}, {3.749587760131122*^9, 
   3.7495877604471684`*^9}, {3.749763678759679*^9, 3.749763690381565*^9}, {
   3.749763881161853*^9, 3.7497639007406597`*^9}, {3.749763943256238*^9, 
   3.749763959686335*^9}, {3.7497714188908377`*^9, 3.749771439202767*^9}, {
   3.74982921350916*^9, 3.749829221629135*^9}, {3.749829707066264*^9, 
   3.7498297196310368`*^9}, 3.749918529472308*^9, {3.7499191365465508`*^9, 
   3.749919137446918*^9}, {3.750475961782165*^9, 3.750475970348247*^9}, {
   3.750477108441189*^9, 3.7504771618505907`*^9}, {3.750477465968931*^9, 
   3.750477475112364*^9}, {3.7505607598932047`*^9, 3.750560763098124*^9}, {
   3.751810937584548*^9, 3.7518109533751783`*^9}, {3.751811489773809*^9, 
   3.751811561950897*^9}, {3.7518118024222927`*^9, 3.751811844782062*^9}, {
   3.7518125488639*^9, 3.751812600723185*^9}, {3.7518126374739857`*^9, 
   3.751812703969184*^9}, {3.751812934543771*^9, 3.751812934692981*^9}, {
   3.751813015430941*^9, 3.751813042664275*^9}, {3.7518148298544483`*^9, 
   3.751814830122332*^9}, {3.751819111462657*^9, 3.751819113129416*^9}, {
   3.751831724344057*^9, 3.751831729306036*^9}, {3.7518505664170322`*^9, 
   3.751850579768682*^9}, 3.751850822810646*^9, {3.752893403380947*^9, 
   3.752893538607489*^9}, {3.7528935716914377`*^9, 3.752893587584464*^9}, {
   3.7528936189617023`*^9, 3.752893619093384*^9}, {3.752894128353402*^9, 
   3.752894136362237*^9}, {3.752894213154997*^9, 3.752894337795062*^9}, {
   3.752894402898535*^9, 3.752894483877335*^9}, {3.752894591537696*^9, 
   3.75289459894217*^9}, {3.752894632570223*^9, 3.752894639098567*^9}, {
   3.752894698845552*^9, 3.7528947752361603`*^9}, {3.7528948187314672`*^9, 
   3.752894838783592*^9}, {3.752895078283527*^9, 3.752895129371352*^9}, {
   3.752895243562286*^9, 3.752895256194869*^9}, {3.752897294773044*^9, 
   3.752897296890174*^9}, {3.752937247193342*^9, 3.752937250189735*^9}, 
   3.752937448344542*^9, {3.752950364918768*^9, 3.752950369305798*^9}, {
   3.752950833820903*^9, 3.752950835798113*^9}, {3.752950973781577*^9, 
   3.7529509881214943`*^9}, {3.752951105096426*^9, 3.752951179066635*^9}, {
   3.7529512142978354`*^9, 3.752951214388245*^9}, {3.752952741387607*^9, 
   3.752952745694968*^9}, {3.7529532052093287`*^9, 3.75295320736707*^9}, {
   3.752953353033779*^9, 3.752953360770131*^9}, {3.752953681496983*^9, 
   3.7529536829283*^9}, {3.752953960931753*^9, 3.752953972666893*^9}, {
   3.752954111806077*^9, 3.752954113632807*^9}, {3.752955026392874*^9, 
   3.752955049346692*^9}, {3.752955090391477*^9, 3.752955106841086*^9}, {
   3.752955186874584*^9, 3.752955226042705*^9}, {3.7529552782802153`*^9, 
   3.752955294114819*^9}, {3.752955379795632*^9, 3.75295539587084*^9}, {
   3.7529555205907393`*^9, 3.75295552203209*^9}, {3.752955562633211*^9, 
   3.752955565238083*^9}, {3.7529556336218853`*^9, 3.752955645222836*^9}, {
   3.753029127696501*^9, 3.7530291278759823`*^9}, {3.753029554055846*^9, 
   3.7530295544868593`*^9}, {3.7530299159297247`*^9, 3.753029945305748*^9}, {
   3.753030337167046*^9, 3.753030341470745*^9}, {3.753030451864044*^9, 
   3.753030458976904*^9}, {3.7530305340929613`*^9, 3.7530305509442*^9}, {
   3.7530308841909227`*^9, 3.7530308892833233`*^9}, {3.753030989011537*^9, 
   3.753030989197073*^9}, {3.753031776823711*^9, 3.7530317825098543`*^9}, {
   3.753031953645413*^9, 3.753031954165752*^9}, {3.753032417316751*^9, 
   3.753032431531197*^9}, {3.753032550301746*^9, 3.753032550440906*^9}, 
   3.753032894012949*^9, {3.753033237646079*^9, 3.7530332394712133`*^9}, {
   3.7530334441521873`*^9, 3.753033463083189*^9}, {3.7530372815902777`*^9, 
   3.7530372984167547`*^9}, {3.753037335430272*^9, 3.7530373648487787`*^9}, {
   3.7530382587778587`*^9, 3.753038280521874*^9}, {3.753040967570965*^9, 
   3.7530409700918417`*^9}, {3.753043628573166*^9, 3.7530436748715343`*^9}, 
   3.753053594940422*^9, {3.753053631514986*^9, 3.753053638654249*^9}, {
   3.7530536805019217`*^9, 3.753053699928677*^9}, {3.753053794159343*^9, 
   3.753053799322956*^9}, {3.753053894129994*^9, 3.7530539297096453`*^9}, {
   3.7530541277264233`*^9, 3.753054128096628*^9}, {3.753054186026382*^9, 
   3.753054190219845*^9}, {3.7530547383116703`*^9, 3.753054756774881*^9}, {
   3.753054826859599*^9, 3.7530548321047087`*^9}, {3.753055015408577*^9, 
   3.7530550213596497`*^9}, {3.753055080036275*^9, 3.753055084592904*^9}, {
   3.753055147699463*^9, 3.753055149189435*^9}, {3.7530553121779003`*^9, 
   3.753055315812923*^9}, {3.7530554039610147`*^9, 3.753055436765093*^9}, {
   3.753055743461211*^9, 3.753055744460301*^9}, {3.7530564354300003`*^9, 
   3.753056435552809*^9}, {3.7530565000497723`*^9, 3.753056501589766*^9}, {
   3.7530568206576138`*^9, 3.7530568520741777`*^9}, {3.753057087019557*^9, 
   3.753057155650066*^9}, {3.7530572024493523`*^9, 3.7530572054923077`*^9}, {
   3.753059693833605*^9, 3.753059711868308*^9}, 3.753059795499174*^9, {
   3.753121300829884*^9, 3.753121346405818*^9}, 3.753121560229154*^9, {
   3.7531228074802113`*^9, 3.753122835110176*^9}, {3.753123490119872*^9, 
   3.7531234951152887`*^9}, {3.7531250036390667`*^9, 3.753125010898357*^9}, 
   3.753125055291244*^9, {3.7531262521848307`*^9, 3.753126252318206*^9}, {
   3.753144020069543*^9, 3.753144069668065*^9}, {3.753144148901133*^9, 
   3.7531441507593107`*^9}, {3.753144376786982*^9, 3.753144404676094*^9}, {
   3.753149742955834*^9, 3.753149743611452*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"36793f65-e109-48c5-bb5f-cea958de743e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"External", " ", "forces"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"externalForces", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", "nVars"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.752935575058041*^9, 3.752935608936143*^9}, {
   3.752935649230603*^9, 3.752935735476007*^9}, {3.752935872808815*^9, 
   3.7529358748585043`*^9}, {3.752936440428615*^9, 3.752936616693562*^9}, {
   3.752937494883192*^9, 3.752937499065572*^9}, {3.752937565566793*^9, 
   3.7529375900515947`*^9}, {3.752937659774583*^9, 3.752937686392194*^9}, {
   3.752937797550473*^9, 3.752937799130527*^9}, {3.7529378492128572`*^9, 
   3.752937849498748*^9}, 3.752944074567472*^9, {3.752945464326747*^9, 
   3.7529454644735107`*^9}, {3.75294572976758*^9, 3.752945735285262*^9}, 
   3.752953339925069*^9, 3.753038406727952*^9, {3.753038469264722*^9, 
   3.7530384741722937`*^9}, {3.753038599911993*^9, 3.753038628746689*^9}, {
   3.7530388055214367`*^9, 3.75303880617278*^9}, {3.753040014777594*^9, 
   3.753040034498519*^9}, {3.753040085829812*^9, 3.753040088202881*^9}, {
   3.7530401419061127`*^9, 3.753040166950306*^9}, {3.753040715904173*^9, 
   3.753040741916409*^9}, {3.7530408027135*^9, 3.753040804111864*^9}, {
   3.753040868309145*^9, 3.753040868700035*^9}, {3.75304392300611*^9, 
   3.753043924330562*^9}, {3.753043986681858*^9, 3.753044001242547*^9}, {
   3.7530440679101467`*^9, 3.753044068562551*^9}, {3.7530441298971453`*^9, 
   3.753044133633484*^9}, 3.753044223590147*^9, {3.753044403330976*^9, 
   3.753044423209805*^9}, {3.753044518103092*^9, 3.753044551623597*^9}, {
   3.7530445957705917`*^9, 3.753044623392209*^9}, {3.753056307701136*^9, 
   3.753056309946928*^9}, {3.753056363603239*^9, 3.753056380406089*^9}, {
   3.753056888265921*^9, 3.753056892818964*^9}, {3.753056931301005*^9, 
   3.75305693211362*^9}, {3.7530569740994663`*^9, 3.7530570011315737`*^9}, {
   3.753057040838358*^9, 3.753057040930401*^9}, {3.7530572217140703`*^9, 
   3.753057222900476*^9}, {3.753059657491391*^9, 3.753059671269434*^9}, {
   3.7530597489621468`*^9, 3.753059778215307*^9}, {3.753121287300314*^9, 
   3.753121291064706*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"5a24985b-711d-4894-ad33-7682092f3681"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Solve", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"nCons", ">", "0"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"with", " ", "constraints"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"EulerLagEqs", "=", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"ELeqsLeft", "==", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"consgrad", ".", "\[Lambda]s"}], "]"}], "+", 
            "externalForces"}]}], "]"}], "//", "Simplify"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"consddtEqs", "=", 
        RowBox[{"TurnToEq", "[", 
         RowBox[{"consddt", ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", "nCons"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"EQ", "=", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"EulerLagEqs", ",", "consddtEqs"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"ddqs", ",", 
            RowBox[{"Flatten", "[", "\[Lambda]s", "]"}]}], "]"}]}], "]"}]}]}],
       ")"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"No", " ", "constraint"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EulerLagEqs", "=", 
       RowBox[{
        RowBox[{"TurnToEq", "[", 
         RowBox[{"ELeqsLeft", ",", "externalForces"}], "]"}], "//", 
        "Simplify"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"EQ", "=", 
       RowBox[{"Solve", "[", 
        RowBox[{"EulerLagEqs", ",", "ddqs"}], "]"}]}]}]}], "]"}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.752894791337954*^9, 3.752894814974654*^9}, {
   3.752894861220069*^9, 3.752894947329397*^9}, {3.7528950298906193`*^9, 
   3.75289504542104*^9}, {3.7528955370653543`*^9, 3.752895636265217*^9}, {
   3.752895721485224*^9, 3.752895767437024*^9}, {3.7528958460723*^9, 
   3.7528959107494164`*^9}, {3.7528993069704723`*^9, 3.752899353134206*^9}, {
   3.752930426490055*^9, 3.752930426910009*^9}, {3.752930465292056*^9, 
   3.752930483791888*^9}, {3.752936640855112*^9, 3.752936650163219*^9}, {
   3.7529376950299673`*^9, 3.7529376956415358`*^9}, {3.752938441192172*^9, 
   3.752938502431718*^9}, 3.752938540913069*^9, {3.7529387268581953`*^9, 
   3.752938800482499*^9}, {3.752942230879902*^9, 3.7529422362590523`*^9}, 
   3.752942793385557*^9, {3.752944065537396*^9, 3.7529440816159*^9}, {
   3.752944159773369*^9, 3.752944161585534*^9}, {3.7529454345696087`*^9, 
   3.752945470933591*^9}, 3.752945658706089*^9, {3.7529457655925827`*^9, 
   3.752945776537252*^9}, {3.752945812077977*^9, 3.7529458382584753`*^9}, {
   3.7529467425591593`*^9, 3.752946744024117*^9}, {3.752949016390222*^9, 
   3.752949025020351*^9}, {3.75294911830159*^9, 3.75294913716702*^9}, {
   3.752949420279763*^9, 3.75294942365825*^9}, {3.752949575107119*^9, 
   3.752949593302175*^9}, 3.752949669821959*^9, 3.752950387118744*^9, {
   3.752950879947427*^9, 3.75295091315872*^9}, {3.752950960562579*^9, 
   3.7529509665964518`*^9}, {3.752951039425029*^9, 3.7529510451306877`*^9}, {
   3.752952867830323*^9, 3.7529528756864767`*^9}, {3.7529529562226686`*^9, 
   3.7529529804809427`*^9}, {3.7529530170247383`*^9, 3.752953047957822*^9}, {
   3.7529531109964*^9, 3.7529531263086843`*^9}, {3.75295492293137*^9, 
   3.752954931587804*^9}, {3.753029206422752*^9, 3.7530292108843937`*^9}, {
   3.753029374045969*^9, 3.753029378352652*^9}, {3.753030992128134*^9, 
   3.7530309950536013`*^9}, {3.7530328590966063`*^9, 
   3.7530328607178926`*^9}, {3.7530328975440607`*^9, 3.753032921903851*^9}, {
   3.753037562588705*^9, 3.753037592619924*^9}, {3.753037998688301*^9, 
   3.753038001515575*^9}, {3.75303836100005*^9, 3.753038361166893*^9}, {
   3.753039353032297*^9, 3.753039360728264*^9}, {3.753040231759441*^9, 
   3.7530402427932997`*^9}, {3.7530402728058453`*^9, 3.753040273328285*^9}, {
   3.753040311185645*^9, 3.753040394112318*^9}, {3.7530407232518*^9, 
   3.753040725716365*^9}, {3.7530438202913713`*^9, 3.753043837708232*^9}, {
   3.7530438807984667`*^9, 3.7530438814270906`*^9}, {3.753043927016801*^9, 
   3.753043928689036*^9}, 3.753044019328925*^9, {3.753044162894352*^9, 
   3.7530441630360823`*^9}, {3.753044406619227*^9, 3.753044407989787*^9}, {
   3.753044523312976*^9, 3.7530445260554247`*^9}, {3.753045895309931*^9, 
   3.7530460196736927`*^9}, {3.75304607997691*^9, 3.753046097625287*^9}, 
   3.753050201230822*^9, 3.753050906794511*^9, {3.7530518883881273`*^9, 
   3.753051958587449*^9}, 3.753052592904687*^9, {3.7530539791759663`*^9, 
   3.753054065207841*^9}, {3.753054155689086*^9, 3.753054156114105*^9}, {
   3.753054851928958*^9, 3.753054928625489*^9}, {3.753054964858341*^9, 
   3.753054998643321*^9}, {3.753056069642933*^9, 3.753056094573173*^9}, {
   3.753056175591939*^9, 3.7530561795283012`*^9}, {3.753056214962792*^9, 
   3.753056245126135*^9}, {3.753056560058378*^9, 3.753056564694744*^9}, {
   3.7531262059230423`*^9, 3.753126217340637*^9}, {3.753126261051106*^9, 
   3.753126263902464*^9}, {3.753126545253314*^9, 3.753126545380416*^9}, {
   3.7531496619563932`*^9, 3.75314967267875*^9}},
 CellLabel->
  "In[971]:=",ExpressionUUID->"c77ea872-647e-4514-a418-f5dc43c7ff34"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Preprae", " ", "for", " ", "NDSolve"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"SetUpImpacts", "\n", 
   RowBox[{
    RowBox[{"ddqSolve", "=", 
     RowBox[{"TurnToEq", "[", 
      RowBox[{"ddqs", ",", 
       RowBox[{"EQ", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", ";;", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "NDsolve", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timeend", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MAXIMPACTTIMES", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ifprint", "=", "True"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"impactDetectionError", "=", "0.01"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"intergrationMaxStepSize", "=", "0.01"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"end", ",", "data", ",", "bounces"}], "}"}], "=", 
     RowBox[{"BouncingBall", "[", 
      RowBox[{"qsInit", ",", "dqsInit"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7531494921779003`*^9, 3.753149514285117*^9}, {
  3.753149702606944*^9, 3.75314970631465*^9}, {3.753152082562064*^9, 
  3.753152084237487*^9}, {3.753152173114102*^9, 3.7531521761890917`*^9}, {
  3.753153698542796*^9, 3.753153728937303*^9}},
 CellLabel->
  "In[972]:=",ExpressionUUID->"c1a43f81-3db8-4f78-9104-411f67c585f2"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Impact detected at: t=\"\>", "\[InvisibleSpace]", 
   "0.6388765639854294`", "\[InvisibleSpace]", "\<\",impactcase=\"\>", 
   "\[InvisibleSpace]", "0"}],
  SequenceForm[
  "Impact detected at: t=", 0.6388765639854294, ",impactcase=", 0],
  Editable->False]], "Print",
 CellChangeTimes->{{3.753152177715534*^9, 3.7531522161655083`*^9}, {
   3.753152277802917*^9, 3.753152299128064*^9}, {3.753152332507958*^9, 
   3.7531523512081337`*^9}, 3.753152387158164*^9, {3.75315243164931*^9, 
   3.7531524477415133`*^9}, {3.7531528319013166`*^9, 3.753152857803761*^9}, 
   3.753152892490958*^9, {3.753152975076748*^9, 3.753152989330935*^9}, 
   3.7531530586916103`*^9, {3.753153175519775*^9, 3.7531531901399727`*^9}, {
   3.753153226918968*^9, 3.753153235572806*^9}, 3.753153280532555*^9, 
   3.753153341875589*^9, {3.7531535367914057`*^9, 3.753153562811543*^9}, 
   3.753153628039435*^9, {3.75315373006026*^9, 3.7531537740391893`*^9}, {
   3.753153918696102*^9, 3.753153943496688*^9}, 3.7531547993173*^9, 
   3.753155036640109*^9},
 CellLabel->
  "During evaluation of \
In[972]:=",ExpressionUUID->"50211b37-8482-44eb-a5bd-8bb68aada19d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    Before reflection, q=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", 
     RowBox[{"-", "2.0000000000000004`"}], ",", "0.`"}], "}"}], 
   "\[InvisibleSpace]", "\<\",dq=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", 
     RowBox[{"-", "6.260990327057203`"}], ",", "0.`"}], "}"}]}],
  SequenceForm[
  "    Before reflection, q=", {0., -2.0000000000000004`, 0.}, ",dq=", {
   0., -6.260990327057203, 0.}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.753152177715534*^9, 3.7531522161655083`*^9}, {
   3.753152277802917*^9, 3.753152299128064*^9}, {3.753152332507958*^9, 
   3.7531523512081337`*^9}, 3.753152387158164*^9, {3.75315243164931*^9, 
   3.7531524477415133`*^9}, {3.7531528319013166`*^9, 3.753152857803761*^9}, 
   3.753152892490958*^9, {3.753152975076748*^9, 3.753152989330935*^9}, 
   3.7531530586916103`*^9, {3.753153175519775*^9, 3.7531531901399727`*^9}, {
   3.753153226918968*^9, 3.753153235572806*^9}, 3.753153280532555*^9, 
   3.753153341875589*^9, {3.7531535367914057`*^9, 3.753153562811543*^9}, 
   3.753153628039435*^9, {3.75315373006026*^9, 3.7531537740391893`*^9}, {
   3.753153918696102*^9, 3.753153943496688*^9}, 3.7531547993173*^9, 
   3.7531550366424303`*^9},
 CellLabel->
  "During evaluation of \
In[972]:=",ExpressionUUID->"3b064d8b-84cd-4186-8c3b-65a06e5c31f3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    After reflection\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "6.260990327057202`", ",", "0.`"}], "}"}]}],
  SequenceForm["    After reflection", {0., 6.260990327057202, 0.}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.753152177715534*^9, 3.7531522161655083`*^9}, {
   3.753152277802917*^9, 3.753152299128064*^9}, {3.753152332507958*^9, 
   3.7531523512081337`*^9}, 3.753152387158164*^9, {3.75315243164931*^9, 
   3.7531524477415133`*^9}, {3.7531528319013166`*^9, 3.753152857803761*^9}, 
   3.753152892490958*^9, {3.753152975076748*^9, 3.753152989330935*^9}, 
   3.7531530586916103`*^9, {3.753153175519775*^9, 3.7531531901399727`*^9}, {
   3.753153226918968*^9, 3.753153235572806*^9}, 3.753153280532555*^9, 
   3.753153341875589*^9, {3.7531535367914057`*^9, 3.753153562811543*^9}, 
   3.753153628039435*^9, {3.75315373006026*^9, 3.7531537740391893`*^9}, {
   3.753153918696102*^9, 3.753153943496688*^9}, 3.7531547993173*^9, 
   3.753155036645276*^9},
 CellLabel->
  "During evaluation of \
In[972]:=",ExpressionUUID->"14fab6ed-82b9-4ec9-8e79-b054794c0b38"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Impact detected at: t=\"\>", "\[InvisibleSpace]", 
   "1.916629679066752`", "\[InvisibleSpace]", "\<\",impactcase=\"\>", 
   "\[InvisibleSpace]", "0"}],
  SequenceForm["Impact detected at: t=", 1.916629679066752, ",impactcase=", 0],
  Editable->False]], "Print",
 CellChangeTimes->{{3.753152177715534*^9, 3.7531522161655083`*^9}, {
   3.753152277802917*^9, 3.753152299128064*^9}, {3.753152332507958*^9, 
   3.7531523512081337`*^9}, 3.753152387158164*^9, {3.75315243164931*^9, 
   3.7531524477415133`*^9}, {3.7531528319013166`*^9, 3.753152857803761*^9}, 
   3.753152892490958*^9, {3.753152975076748*^9, 3.753152989330935*^9}, 
   3.7531530586916103`*^9, {3.753153175519775*^9, 3.7531531901399727`*^9}, {
   3.753153226918968*^9, 3.753153235572806*^9}, 3.753153280532555*^9, 
   3.753153341875589*^9, {3.7531535367914057`*^9, 3.753153562811543*^9}, 
   3.753153628039435*^9, {3.75315373006026*^9, 3.7531537740391893`*^9}, {
   3.753153918696102*^9, 3.753153943496688*^9}, 3.7531547993173*^9, 
   3.753155036660598*^9},
 CellLabel->
  "During evaluation of \
In[972]:=",ExpressionUUID->"34ccd741-c012-4e0b-afd2-fcebcc2fe1e0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    Before reflection, q=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", 
     RowBox[{"-", "2.0000000000000075`"}], ",", "0.`"}], "}"}], 
   "\[InvisibleSpace]", "\<\",dq=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", 
     RowBox[{"-", "6.260990200739752`"}], ",", "0.`"}], "}"}]}],
  SequenceForm[
  "    Before reflection, q=", {0., -2.0000000000000075`, 0.}, ",dq=", {
   0., -6.260990200739752, 0.}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.753152177715534*^9, 3.7531522161655083`*^9}, {
   3.753152277802917*^9, 3.753152299128064*^9}, {3.753152332507958*^9, 
   3.7531523512081337`*^9}, 3.753152387158164*^9, {3.75315243164931*^9, 
   3.7531524477415133`*^9}, {3.7531528319013166`*^9, 3.753152857803761*^9}, 
   3.753152892490958*^9, {3.753152975076748*^9, 3.753152989330935*^9}, 
   3.7531530586916103`*^9, {3.753153175519775*^9, 3.7531531901399727`*^9}, {
   3.753153226918968*^9, 3.753153235572806*^9}, 3.753153280532555*^9, 
   3.753153341875589*^9, {3.7531535367914057`*^9, 3.753153562811543*^9}, 
   3.753153628039435*^9, {3.75315373006026*^9, 3.7531537740391893`*^9}, {
   3.753153918696102*^9, 3.753153943496688*^9}, 3.7531547993173*^9, 
   3.753155036662116*^9},
 CellLabel->
  "During evaluation of \
In[972]:=",ExpressionUUID->"39df5dee-6470-49ac-ba96-d2339239f789"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    After reflection\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "6.260990200739741`", ",", "0.`"}], "}"}]}],
  SequenceForm["    After reflection", {0., 6.260990200739741, 0.}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.753152177715534*^9, 3.7531522161655083`*^9}, {
   3.753152277802917*^9, 3.753152299128064*^9}, {3.753152332507958*^9, 
   3.7531523512081337`*^9}, 3.753152387158164*^9, {3.75315243164931*^9, 
   3.7531524477415133`*^9}, {3.7531528319013166`*^9, 3.753152857803761*^9}, 
   3.753152892490958*^9, {3.753152975076748*^9, 3.753152989330935*^9}, 
   3.7531530586916103`*^9, {3.753153175519775*^9, 3.7531531901399727`*^9}, {
   3.753153226918968*^9, 3.753153235572806*^9}, 3.753153280532555*^9, 
   3.753153341875589*^9, {3.7531535367914057`*^9, 3.753153562811543*^9}, 
   3.753153628039435*^9, {3.75315373006026*^9, 3.7531537740391893`*^9}, {
   3.753153918696102*^9, 3.753153943496688*^9}, 3.7531547993173*^9, 
   3.7531550366633873`*^9},
 CellLabel->
  "During evaluation of \
In[972]:=",ExpressionUUID->"c07a81b8-0b3d-4497-9ffb-07e97171eee0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Plot", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"qsPlot", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Piecewise", "[", 
        RowBox[{
         RowBox[{"qsvars", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/.", "data"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nVars"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"Evaluate", "[", "qsPlot", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "end"}], "}"}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", "qs"}], ",", "\n", "\t", 
      RowBox[{"PlotRange", "->", "Automatic"}], ",", 
      RowBox[{"Frame", "->", "True"}], ",", 
      RowBox[{"FrameLabel", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<time\>\"", ",", "\"\<value\>\""}], "}"}]}]}], "]"}], 
    "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7504780748676167`*^9, 3.7504781009956417`*^9}, {
   3.750478131022161*^9, 3.75047825313091*^9}, {3.7504784047822657`*^9, 
   3.750478452345035*^9}, {3.7504785375333223`*^9, 3.7504785598367968`*^9}, {
   3.75181111432718*^9, 3.7518111194813337`*^9}, {3.751819873464633*^9, 
   3.751819904822239*^9}, {3.751835006922633*^9, 3.751835031902342*^9}, {
   3.753148727471694*^9, 3.753148811016508*^9}, {3.753148849969969*^9, 
   3.753148859135503*^9}, {3.75314889059431*^9, 3.7531488911543083`*^9}, {
   3.753149009625237*^9, 3.753149032487109*^9}, {3.753149307897419*^9, 
   3.7531493143852797`*^9}, 3.753153232631824*^9, {3.753153992829939*^9, 
   3.753154008600006*^9}, {3.7531541408024883`*^9, 3.753154216688665*^9}, {
   3.753154270230612*^9, 3.753154288334462*^9}, 3.753154548445094*^9, 
   3.753154804338324*^9, {3.7531548532640867`*^9, 3.753154897765727*^9}},
 CellLabel->
  "In[980]:=",ExpressionUUID->"7397f069-2f50-47dd-97e4-bc64fd0d50b9"],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{{{}, {}, 
       TagBox[{
         Directive[
          Opacity[1.], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         LineBox[CompressedData["
1:eJxF0HssFAAcB/DDNco6Tg87wk5UXjFJSaVikUfNo8nympCuF7KVVtO1O8kj
1kzK+5HSjSN31nJi3GzMI44d7dzp3HScZznXkbtqq9/vt3333ee/737UuNsh
CboEAiHoT/62f4J8uHM24STh3xG9zZIlFB+v/z5UUVzaQgkDBwwI35dR4sHh
8ar255Q08KTzE+88CgNcuetCZjalEEw3aNn/lFILvhRRxV5e4YANtfRIX8sO
sG3worw7hw++O+jhVbzaCzblkMU6OkPgVql3/9DxEXAXrcw8Yn4UrNx3wqjh
phCsq2YZm9t+AbtrY1tDG0XgfobbYI+9BGxVoFDXL06BFSqJeMxFCq6da+sj
PZsGkyzeLMlkMnDuNW5ipc0MeO0US5aU8Q2c5srn7O6WgyWN/Jxh6hx4gzZa
YndfAXY4ra9JbJsH+1ZTrzabLuK/LGKsv0YugR3nLxoKg5bBO4yWDfjraGJH
CXtv6Qr4ulvbxNaA72DWubjKT2topcLMeKboB5gb6qtX6LMKzvBjVnBm0NRJ
//EaphJ87AijkOK6Bo60HFLrCNDKvjxpMl0FLiZGp4XY/MT9Ym61Lh+95SE9
zCNFDSbUR7OlJuvg1FfsPJMudLtDlgH51gaY7J/q+Jj0Cyxy+ixI56Gbyr1s
ZNGb4Ci2O9lCg37ErKKL3mnADXKLElKgFpxVxowVn0fHhyzYNgaj9/B4TUHh
6Oz8yz25cegk95cr29LR1oydfvp1aM3RB9uFb9ETC9MjdSx0QXhL1NlmtNY+
5A6ThxYN55frCdAfMlVXBGPoQs8Yu5pxdMDrg5wzYvTHewO99Fl0kdPh/OB5
dIq0NIy6hD4QeEPSuYom6ozWFqjQU1xPWuw6mkercXbZRL+wMlRqtejfswdC
7w==
          "]]}, Annotation[#, "Charting`Private`Tag$256014#1"]& ], 
       TagBox[{
         Directive[
          Opacity[1.], 
          RGBColor[0.880722, 0.611041, 0.142051], 
          AbsoluteThickness[1.6]], 
         LineBox[CompressedData["
1:eJwVx3s0FIgewHFJ3TmRR8dWCAmzkka1pPYavyJXK9QwFSaz3pK88iw3pSjy
2Dwa4xFNRouM0TCGKX5jZnCMV81q3ShkqcmVVznuXeLu/eN7Pudr5B/pHqSs
pKQU+Ff/1zlI8Ur0KchOSUkxpMlRblVx0I0a0zkBSpctYwVbsO2HcmZpgw4V
jnEXHwqXRtsmd5mkJBDpoEkr0VgLWWg71TfEe6gTCGdUyrle82ttJln6leuG
oaD4TSI5to+Aq84BhX7ECPCkvA56GKyF06mDUj9GNBxZbk/Yyt2B5wOXW/N0
YqF25NfC+VkDlDroCiSl8UC9IfE3zjfGA8bk+q+GV2FbPVcp3dwMS5V9q00r
kkD7JtP0CXk/EiZuPT5HTIba5TaFXfBBFI7L+yTUm7CwZnnrbpgVRp0JdL7A
SIHfzxqO1dbZ4DvLuw7ZOqmQsZj4R/asHRaU7xSZ0tLAojS6gx13HJ01amzb
Su/AxIepP+fzHLBpttd6zjADRF9UM6nmJ/Eync6763cPFPzWqTC2M+7pnyPt
rsiEiXLS42iyK+ZwtplRiDnAXiLuNgmmoKM+m/0p5BegEdfuq713x+TOYs12
6n1YmW48dDmMilaHLbK9GLmwYNlOyK07j4++O33nnk4BiKuo61GzdEzqK5Se
ExaAj21BUsYVXzyXNq5sTHsAbrOfNRhxfqi2FH3jeSkDttbPb5jIC8DEwYLE
GcMiWKn5QdXR/CJ6ZL1rahYVQfFEiexKQCiSThCXUv2KwWIyZs8F9iWcbBBE
61eUwH7HmBI/cjhS8ocvuRHLwB3Pv9ELjkaLU8bVul1lsKjco8syuoKEjZc/
fggph5x98WYq76/gzy1rz5D6COr3xVYFhMXid3vvkzwZLKj7qP739LoETCE0
fJ+hw4YcN6wJmU1Gc6fcdF4UG2z6br+dX72B8rTITyNdbLh405mrnH4TTTZa
PCXFV0KEpH+vgpWCnd/YpEH5EzC7W6G0PH8b1b4wrA2zqsF7U7K1yWo68g/G
MU7+UQ32Mx1nJL9mID3KYzn6xxpg77fSrjp7D7mfNVqkihp4ibfz7Zsz0V2R
bnvJsRaGjeZinjNzkPnumgN/rQ6oESs+9IA8PL7Liz16lgt51nILWk8eTnvb
bCJwuLDV/MXANat8NJi5GsDZXw/Nxd25e7YUYGToYVOlt/UwWSzbrC15gNsC
uVWVR3hQsj2oMTmsCD29WNz5hUYQffuWc7TnEc6NULc81uWDdomGi1CNhXfo
hCAPBz6obXj9ssWNhQ0BkbpNBXyYISYdtB5koXoEOS3Jpgkih61O6089xo5b
b7w3XxfA1XGfVZ5BJR6q1dq8iyCEoot39L/OV2M3qcO378Bfr6v1ytW+Bn2f
JT5P9hKC3YPTLsSCGsxuGot6XyOExMmPRR5Hn6JCxBl54vocaqfTcsszarHs
9U/PDua/AD1GwuLqcS6qrqdccDJASG1ktn5I5yEz9Dzd4h8IKQvjoZnNPDQZ
tPDVikC4Xl+8MVzBQ7vqoYCRVoTYRv/1DycbsKWawReQROA9eGJnk1ojfvaY
eXGqXwTKsZQBUTkfz1YV9sRsFUPnoSz39C/NWOpzyyXYSAx1XBWOzLwFJ7aF
93laiyGvbvbrT/4tGHndfoDsIwbaoR2u669aMMP9s/xvHDFMUoQGjo1CbF21
Hy5xkYB8/qQTOfUFmlJmFZJMKWgOSX6fMxOh7g2nH0NYUpjxFPirnhKhJudR
5haBFFqloV3O4SL8k+BBokxI4bC3qp41T4QvRYKY0SMdwPjn8X8LyO147UDK
2n+mOmCl7KplPE2M/Rra2qRjXRDsreP0+pkUE/qPAvNrN3Q83d6gL+tGdRJ/
qpsgg80XNG67LXYjO/tA1souGeyukGeW6crwlcv3b+iOMvi41OxUGibDfT3a
MaYMGTRxVELVNXpwrGvuCc+mB34OZlL6aL3o1F6p3netF35bqRfy1QZwR6PW
6IYNA8CiecTvDJZj04RD74CtHOhtSa4GCW9QfOmhntfMILzdK3pnLx7HJSJZ
gxM+BCSzXyqMNk6h8n+fauqZDoP7Widz1HwaD6/7NnnUvYXVI2TbuOtz2Jtq
1d9pPgY+CcpLvYWLGLcp30DSMwZTttv/Zen7Bf8HnC4ywg==
          "]], 
         LineBox[CompressedData["
1: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
hH8Z9Edcq72RhufL0m0FHZf//7/1P5xHMAo=
          "]]}, 
        Annotation[#, "Charting`Private`Tag$256014#2"]& ], 
       TagBox[{
         Directive[
          Opacity[1.], 
          RGBColor[0.560181, 0.691569, 0.194885], 
          AbsoluteThickness[1.6]], 
         LineBox[CompressedData["
1:eJxF0HssFAAcB/DDNco6Tg87wk5UXjFJSaVikUfNo8nympCuF7KVVtO1O8kj
1kzK+5HSjSN31nJi3GzMI44d7dzp3HScZznXkbtqq9/vt3333ee/737UuNsh
CboEAiHoT/62f4J8uHM24STh3xG9zZIlFB+v/z5UUVzaQgkDBwwI35dR4sHh
8ar255Q08KTzE+88CgNcuetCZjalEEw3aNn/lFILvhRRxV5e4YANtfRIX8sO
sG3worw7hw++O+jhVbzaCzblkMU6OkPgVql3/9DxEXAXrcw8Yn4UrNx3wqjh
phCsq2YZm9t+AbtrY1tDG0XgfobbYI+9BGxVoFDXL06BFSqJeMxFCq6da+sj
PZsGkyzeLMlkMnDuNW5ipc0MeO0US5aU8Q2c5srn7O6WgyWN/Jxh6hx4gzZa
YndfAXY4ra9JbJsH+1ZTrzabLuK/LGKsv0YugR3nLxoKg5bBO4yWDfjraGJH
CXtv6Qr4ulvbxNaA72DWubjKT2topcLMeKboB5gb6qtX6LMKzvBjVnBm0NRJ
//EaphJ87AijkOK6Bo60HFLrCNDKvjxpMl0FLiZGp4XY/MT9Ym61Lh+95SE9
zCNFDSbUR7OlJuvg1FfsPJMudLtDlgH51gaY7J/q+Jj0Cyxy+ixI56Gbyr1s
ZNGb4Ci2O9lCg37ErKKL3mnADXKLElKgFpxVxowVn0fHhyzYNgaj9/B4TUHh
6Oz8yz25cegk95cr29LR1oydfvp1aM3RB9uFb9ETC9MjdSx0QXhL1NlmtNY+
5A6ThxYN55frCdAfMlVXBGPoQs8Yu5pxdMDrg5wzYvTHewO99Fl0kdPh/OB5
dIq0NIy6hD4QeEPSuYom6ozWFqjQU1xPWuw6mkercXbZRL+wMlRqtejfswdC
7w==
          "]]}, 
        Annotation[#, "Charting`Private`Tag$256014#3"]& ]}}, {}, {}}, {
    DisplayFunction -> Identity, Ticks -> {Automatic, Automatic}, 
     AxesOrigin -> {0, 0}, FrameTicks -> {{Automatic, 
        Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, 
        Charting`ScaledFrameTicks[{Identity, Identity}]}}, 
     GridLines -> {None, None}, DisplayFunction -> Identity, 
     PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}}, PlotRangeClipping -> True, ImagePadding -> All, 
     DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, DisplayFunction :> 
     Identity, Frame -> {{True, True}, {True, True}}, FrameLabel -> {{
        FormBox["\"value\"", TraditionalForm], None}, {
        FormBox["\"time\"", TraditionalForm], None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {
      "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
       AbsolutePointSize[6], "ScalingFunctions" -> None, 
       "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& )}}, 
     PlotRange -> {{0., 1.9999999591836735`}, {-1.2109831276791791`, 0.}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.02]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox[
     TemplateBox[{
       RowBox[{"$q1", "\[InvisibleApplication]", 
         RowBox[{"(", 
           TagBox["t", HoldForm], ")"}]}], 
       RowBox[{"$q2", "\[InvisibleApplication]", 
         RowBox[{"(", 
           TagBox["t", HoldForm], ")"}]}], 
       RowBox[{"$q3", "\[InvisibleApplication]", 
         RowBox[{"(", 
           TagBox["t", HoldForm], ")"}]}]}, "LineLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.368417`", ",", "0.506779`", ",", "0.709798`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.587148, 0.40736066666666665`, 0.09470066666666668], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.880722`", ",", "0.611041`", ",", "0.142051`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.880722, 0.611041, 0.142051]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.880722, 0.611041, 0.142051], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.37345400000000006`, 0.461046, 0.12992333333333334`], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.560181`", ",", "0.691569`", ",", "0.194885`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.560181, 0.691569, 0.194885]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.560181, 0.691569, 0.194885], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", "None"}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{
  3.75314903295757*^9, {3.753149303410356*^9, 3.753149314851514*^9}, 
   3.7531494991414757`*^9, 3.753149713445228*^9, 3.7531497471326437`*^9, 
   3.753153230515728*^9, {3.7531539450172367`*^9, 3.753154009117021*^9}, 
   3.753154141338092*^9, 3.753154173721539*^9, {3.753154263994341*^9, 
   3.7531542886422358`*^9}, 3.7531548981748457`*^9, 3.753155037311673*^9},
 CellLabel->
  "Out[981]=",ExpressionUUID->"23444979-f72d-4c54-96ae-1b395f752d2e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"plotRect", "[", 
    RowBox[{"T_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "p0", ",", "p1", ",", "p2", ",", "p3", ",", "p4", ",", "p", ",", "pw", 
       ",", "l", ",", "w"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"l", "=", 
       RowBox[{"lens", "[", 
        RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"w", "=", 
       RowBox[{"widths", "[", 
        RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p0", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "w"}], "/", "2"}], ",", 
         RowBox[{"l", "/", "2"}], ",", "0", ",", "1"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p1", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"w", "/", "2"}], ",", 
         RowBox[{"l", "/", "2"}], ",", "0", ",", "1"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p2", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"w", "/", "2"}], ",", 
         RowBox[{
          RowBox[{"-", "l"}], "/", "2"}], ",", "0", ",", "1"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p3", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "w"}], "/", "2"}], ",", 
         RowBox[{
          RowBox[{"-", "l"}], "/", "2"}], ",", "0", ",", "1"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p4", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "w"}], "/", "2"}], ",", 
         RowBox[{"l", "/", "2"}], ",", "0", ",", "1"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"{", 
        RowBox[{"p0", ",", "p1", ",", "p2", ",", "p3", ",", "p4"}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"pw", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"T", ".", 
          RowBox[{"Transpose", "[", "p", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "2"}], ",", ";;"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"pw", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", "2"}], ",", "i"}], "]"}], "]"}], ",", 
           RowBox[{"pw", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", "2"}], ",", 
              RowBox[{"i", "+", "1"}]}], "]"}], "]"}]}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}]}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{" ", 
       RowBox[{"{", 
        RowBox[{"Line1", ",", "Line2", ",", "..."}]}], "]"}], "}"}], "*)"}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotTriangle", "[", "pEnds_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2", ",", "p3", ",", "pw"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"p1", "=", 
      RowBox[{"pEnds", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"p2", "=", 
      RowBox[{"pEnds", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", 
     RowBox[{"p3", "=", 
      RowBox[{"pEnds", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pw", "=", 
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2", ",", "p3", ",", "p1"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pw", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", 
             RowBox[{"1", ";;", "2"}], ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"pw", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", 
             RowBox[{"1", ";;", "2"}], ",", "1"}], "]"}], "]"}]}], "}"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"links", "=", 
   RowBox[{"{", 
    RowBox[{"plotTriangle", "[", "p1Ends", "]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.751118751091413*^9, 3.751118757689159*^9}, {
   3.751118801666729*^9, 3.751118848375704*^9}, {3.7511190462549543`*^9, 
   3.751119096603574*^9}, {3.751160106175243*^9, 3.751160106282084*^9}, {
   3.7528968920839977`*^9, 3.752896931054696*^9}, {3.7528970643922863`*^9, 
   3.7528970850217657`*^9}, {3.752898363356378*^9, 3.7528983639949303`*^9}, 
   3.752898535377866*^9, {3.752930968550906*^9, 3.752931039129393*^9}, {
   3.752931112004519*^9, 3.752931112747387*^9}, {3.752931377819645*^9, 
   3.7529314340380373`*^9}, {3.7529315635671864`*^9, 
   3.7529315943397923`*^9}, {3.75293164368289*^9, 3.752931644269472*^9}, {
   3.75293167656215*^9, 3.752931679101885*^9}, {3.752931714337655*^9, 
   3.752931780152071*^9}, {3.7529352424504757`*^9, 3.7529352484956827`*^9}, {
   3.752935433445023*^9, 3.752935445491578*^9}, {3.753037820864614*^9, 
   3.7530378254409018`*^9}, 3.753044053026998*^9, 3.75304619671243*^9, {
   3.75305182763835*^9, 3.7530518506661777`*^9}, {3.753052269760738*^9, 
   3.753052318096066*^9}, {3.7530523517408123`*^9, 3.753052352626607*^9}, {
   3.753052396789255*^9, 3.753052397694915*^9}, {3.753052431610183*^9, 
   3.7530524969842777`*^9}, {3.753052585589896*^9, 3.753052587838933*^9}, {
   3.753053098045836*^9, 3.753053105395467*^9}, {3.753053269283177*^9, 
   3.7530532702229548`*^9}, {3.753121588118039*^9, 3.753121638046852*^9}, {
   3.753121786920171*^9, 3.75312195563548*^9}, {3.753121986192629*^9, 
   3.753121989480275*^9}, {3.753122030953302*^9, 3.75312205956441*^9}, {
   3.753122129003786*^9, 3.753122140551744*^9}, {3.7531221852110453`*^9, 
   3.7531222295094347`*^9}, {3.75312227640051*^9, 3.753122394166133*^9}, {
   3.753122435071288*^9, 3.753122437772585*^9}, 3.753122485009709*^9, {
   3.753149382369236*^9, 3.753149400527478*^9}},
 CellLabel->
  "In[982]:=",ExpressionUUID->"72acf4bf-c920-417b-a46c-c6e641d76c27"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Animate", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"linksCoords", "[", "i_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"links", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "/.", "sim"}], ")"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"linksCoords", "[", "j_", "]"}], ":=", 
     RowBox[{
      RowBox[{"links", "[", 
       RowBox[{"[", "j", "]"}], "]"}], "/.", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"qs", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
         RowBox[{"qsPlot", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nVars"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LinksForAnimation", "[", "tt_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"linksCoords", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "links", "]"}]}], "}"}]}], "]"}], ")"}], "/.", 
      RowBox[{"t", "\[Rule]", "tt"}]}]}], ";"}], "\n", 
   RowBox[{"Animate", "[", 
    RowBox[{
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"LinksForAnimation", "[", "t", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[IndentingNewLine]", "}"}],
        ",", 
       RowBox[{"PlotRange", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "30"}], ",", "3"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", " ", "True"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "timeend"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.751118751091413*^9, 3.751118757689159*^9}, {
   3.751118801666729*^9, 3.751118848375704*^9}, {3.7511190462549543`*^9, 
   3.751119096603574*^9}, {3.751160106175243*^9, 3.751160106282084*^9}, {
   3.7528968920839977`*^9, 3.752896931054696*^9}, {3.7528970643922863`*^9, 
   3.7528970850217657`*^9}, {3.752898363356378*^9, 3.7528983639949303`*^9}, 
   3.752898535377866*^9, {3.752930968550906*^9, 3.752931039129393*^9}, {
   3.752931112004519*^9, 3.752931112747387*^9}, {3.752931377819645*^9, 
   3.7529314340380373`*^9}, {3.7529315635671864`*^9, 
   3.7529315943397923`*^9}, {3.75293164368289*^9, 3.752931644269472*^9}, {
   3.75293167656215*^9, 3.752931679101885*^9}, {3.752931714337655*^9, 
   3.752931780152071*^9}, {3.7529352424504757`*^9, 3.7529352484956827`*^9}, {
   3.752935433445023*^9, 3.752935445491578*^9}, {3.753037820864614*^9, 
   3.7530378254409018`*^9}, 3.753044053026998*^9, 3.75304619671243*^9, {
   3.75305182763835*^9, 3.7530518506661777`*^9}, {3.753052269760738*^9, 
   3.753052318096066*^9}, {3.7530523517408123`*^9, 3.753052352626607*^9}, {
   3.753052396789255*^9, 3.753052397694915*^9}, {3.753052431610183*^9, 
   3.7530524969842777`*^9}, {3.753052585589896*^9, 3.753052587838933*^9}, {
   3.753053098045836*^9, 3.753053105395467*^9}, {3.753053269283177*^9, 
   3.7530532702229548`*^9}, {3.753121588118039*^9, 3.753121638046852*^9}, {
   3.753121786920171*^9, 3.75312195563548*^9}, {3.753121986192629*^9, 
   3.753121989480275*^9}, {3.753122030953302*^9, 3.75312205956441*^9}, {
   3.753122129003786*^9, 3.753122147192174*^9}, {3.75312254831465*^9, 
   3.753122549156526*^9}, 3.75312681412013*^9, {3.753148949599975*^9, 
   3.753148977232799*^9}, {3.753149176256588*^9, 3.753149186928094*^9}, {
   3.753149366341589*^9, 3.753149427247396*^9}, {3.753154971886162*^9, 
   3.753154972939328*^9}},
 CellLabel->
  "In[985]:=",ExpressionUUID->"a5e5e57a-98e4-4a87-bc00-5d27621ac9a6"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`t$$ = 0.13562393188476562`, Typeset`show$$ =
     True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`t$$], 0, 2}}, Typeset`size$$ = {152., {320., 328.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`t$256098$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`t$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`t$$, $CellContext`t$256098$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[{
         Graphics[
          Part[
           $CellContext`LinksForAnimation[$CellContext`t$$], 1]]}, 
        PlotRange -> {{-3, 3}, {-30, 3}}, Frame -> True], 
      "Specifications" :> {{$CellContext`t$$, 0, 2, 
         AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{486., {372., 381.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.753154978542222*^9, 3.7531550385037193`*^9},
 CellLabel->
  "Out[987]=",ExpressionUUID->"fdc17ae7-f1cf-4424-ae2d-2f06297418a5"]
}, Open  ]]
},
WindowSize->{1358, 847},
WindowMargins->{{4, Automatic}, {56, Automatic}},
Magnification->1.5,
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1243, 20, 74, "Input",ExpressionUUID->"266e0836-dc31-4677-a6fd-4e7ecb2b8656"],
Cell[1804, 42, 17885, 501, 2625, "Input",ExpressionUUID->"8f92c5b0-8289-4350-8eb8-516898d33f22"],
Cell[19692, 545, 4112, 123, 728, "Input",ExpressionUUID->"1bdb90c2-7289-45c2-a579-eed7e16aa45d"],
Cell[23807, 670, 7797, 188, 1389, "Input",ExpressionUUID->"e92d9418-9387-4936-8a0c-7e816792a362"],
Cell[31607, 860, 2652, 46, 184, "Input",ExpressionUUID->"86e25054-c6c5-43bc-b27c-ddc5bfdc0a87"],
Cell[34262, 908, 5363, 163, 520, "Input",ExpressionUUID->"475c42ee-2785-4311-afba-ef5380bb1e53"],
Cell[39628, 1073, 9704, 179, 435, "Input",ExpressionUUID->"36793f65-e109-48c5-bb5f-cea958de743e"],
Cell[49335, 1254, 2284, 36, 82, "Input",ExpressionUUID->"5a24985b-711d-4894-ad33-7682092f3681"],
Cell[51622, 1292, 5761, 113, 320, "Input",ExpressionUUID->"c77ea872-647e-4514-a418-f5dc43c7ff34"],
Cell[CellGroupData[{
Cell[57408, 1409, 1572, 39, 456, "Input",ExpressionUUID->"c1a43f81-3db8-4f78-9104-411f67c585f2"],
Cell[CellGroupData[{
Cell[59005, 1452, 1176, 21, 36, "Print",ExpressionUUID->"50211b37-8482-44eb-a5bd-8bb68aada19d"],
Cell[60184, 1475, 1392, 27, 36, "Print",ExpressionUUID->"3b064d8b-84cd-4186-8c3b-65a06e5c31f3"],
Cell[61579, 1504, 1142, 20, 36, "Print",ExpressionUUID->"14fab6ed-82b9-4ec9-8e79-b054794c0b38"],
Cell[62724, 1526, 1171, 20, 36, "Print",ExpressionUUID->"34ccd741-c012-4e0b-afd2-fcebcc2fe1e0"],
Cell[63898, 1548, 1390, 27, 36, "Print",ExpressionUUID->"39df5dee-6470-49ac-ba96-d2339239f789"],
Cell[65291, 1577, 1144, 20, 36, "Print",ExpressionUUID->"c07a81b8-0b3d-4497-9ffb-07e97171eee0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[66484, 1603, 1965, 41, 184, "Input",ExpressionUUID->"7397f069-2f50-47dd-97e4-bc64fd0d50b9"],
Cell[68452, 1646, 25199, 493, 396, "Output",ExpressionUUID->"23444979-f72d-4c54-96ae-1b395f752d2e"]
}, Open  ]],
Cell[93666, 2142, 6361, 159, 694, "Input",ExpressionUUID->"72acf4bf-c920-417b-a46c-c6e641d76c27"],
Cell[CellGroupData[{
Cell[100052, 2305, 4088, 92, 252, "Input",ExpressionUUID->"a5e5e57a-98e4-4a87-bc00-5d27621ac9a6"],
Cell[104143, 2399, 2151, 44, 804, "Output",ExpressionUUID->"fdc17ae7-f1cf-4424-ae2d-2f06297418a5"]
}, Open  ]]
}
]
*)

